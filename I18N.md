# Internationalization (i18n)

Hasyx includes built-in internationalization support using [next-intl](https://next-intl-docs.vercel.app/), enabling your application to support multiple languages seamlessly.

## Overview

The i18n implementation provides:
- **Multiple language support**: Currently supports English (en) and Russian (ru)
- **Client-side locale switching**: Dynamic language switching without page reload
- **Type-safe translations**: Full TypeScript support for translation keys
- **Organized namespaces**: Translations grouped by feature/component area
- **Easy integration**: Simple hooks for both client and server components

## Quick Start

### Using Translations in Client Components

```tsx
'use client';

import { useTranslations } from 'hasyx/lib/i18n/hook';

export function MyComponent() {
  const t = useTranslations('common');

  return (
    <div>
      <h1>{t('loading')}</h1>
      <button>{t('search')}</button>
    </div>
  );
}
```

### Using Translations in Server Components

```tsx
import { getTranslations } from 'next-intl/server';

export default async function MyServerComponent() {
  const t = await getTranslations('common');

  return (
    <div>
      <h1>{t('loading')}</h1>
    </div>
  );
}
```

### Switching Locales

```tsx
'use client';

import { LocaleSwitcher } from 'hasyx/components/locale-switcher';

export function Header() {
  return (
    <header>
      <LocaleSwitcher />
    </header>
  );
}
```

## Configuration

### Environment Variables

Set the default locale using environment variables:

```bash
NEXT_PUBLIC_LOCALE=en  # or 'ru'
```

### Next.js Configuration

The i18n plugin is already configured in `next.config.ts`:

```typescript
import createNextIntlPlugin from 'next-intl/plugin';

const withNextIntl = createNextIntlPlugin('./lib/i18n/config.ts');

export default withNextIntl(config);
```

### Request Configuration

The request configuration is located in `lib/i18n/config.ts`:

```typescript
import { getRequestConfig } from 'next-intl/server';

export default getRequestConfig(async () => {
  const locale = process.env.NEXT_PUBLIC_LOCALE || 'en';

  return {
    locale,
    timeZone: 'UTC',
    messages: (await import(`../../i18n/${locale}.json`)).default
  };
});
```

## Translation Files

Translation files are located in the `i18n/` directory:

```
i18n/
├── en.json  # English translations
└── ru.json  # Russian translations
```

### Translation Structure

Translations are organized by namespace:

```json
{
  "common": {
    "loading": "Loading...",
    "search": "Search",
    "error": "Error"
  },
  "auth": {
    "signIn": "Sign In",
    "signOut": "Sign Out"
  },
  "actions": {
    "save": "Save",
    "cancel": "Cancel",
    "delete": "Delete"
  }
}
```

## Available Namespaces

The following namespaces are available:

- **common**: Common UI strings (loading, error, yes/no, etc.)
- **config**: Configuration interface strings
- **actions**: Action buttons (save, cancel, delete, etc.)
- **errors**: Error messages
- **success**: Success messages
- **tooltips**: Tooltip text
- **theme**: Theme switcher
- **auth**: Authentication-related strings
- **session**: Session management
- **jwt**: JWT debugging
- **files**: File management
- **messaging**: Chat and messaging
- **notifications**: Notification messages
- **payments**: Payment processing
- **entities**: Entity management (users, accounts, groups, etc.)
- **validationDemo**: Validation form demo
- **pwa**: Progressive Web App prompts
- **proxy**: GraphQL proxy
- **hasura**: Hasura integration
- **usersList**: User list components

## API Reference

### Hooks

#### `useTranslations(namespace?: string)`

Client-side hook for accessing translations.

```tsx
const t = useTranslations('auth');
const message = t('signIn'); // "Sign In"
```

#### `useLocale(defaultLocale?: string)`

Get the current locale and setter function.

```tsx
const { locale, setLocale } = useLocale('en');
```

#### `useLocaleClient(defaultLocale?: string)`

Client-only locale hook (for client components).

```tsx
const { locale, setLocale } = useLocaleClient('en');
```

#### `useLocaleServer(defaultLocale?: string)`

Server-only locale hook (returns static locale).

```tsx
const { locale } = useLocaleServer('en');
```

### Functions

#### `getLocale(): string`

Get the default locale from environment variables.

```typescript
import { getLocale } from 'hasyx/lib/i18n';

const locale = getLocale(); // 'en' or 'ru'
```

#### `i18nMessages(locale: string)`

Get all messages for a specific locale.

```typescript
import { i18nMessages } from 'hasyx/lib/i18n/messages';

const messages = i18nMessages('en');
```

### Components

#### `LocaleSwitcher`

A button component that toggles between available locales.

```tsx
<LocaleSwitcher className="w-full" />
```

## Adding New Translations

### 1. Add Keys to Translation Files

Edit both `i18n/en.json` and `i18n/ru.json`:

```json
// i18n/en.json
{
  "myFeature": {
    "title": "My Feature",
    "description": "This is my feature"
  }
}
```

```json
// i18n/ru.json
{
  "myFeature": {
    "title": "Моя функция",
    "description": "Это моя функция"
  }
}
```

### 2. Use in Your Component

```tsx
import { useTranslations } from 'hasyx/lib/i18n/hook';

export function MyFeature() {
  const t = useTranslations('myFeature');

  return (
    <div>
      <h1>{t('title')}</h1>
      <p>{t('description')}</p>
    </div>
  );
}
```

### 3. Update Translation Checklist

Mark your component as migrated in `translations.md`:

```markdown
- [x] `components/my-feature.tsx` — uses `myFeature.*`
```

## Migration Guide

To migrate existing components to use i18n:

### Before

```tsx
export function OldComponent() {
  return (
    <div>
      <h1>Welcome</h1>
      <button>Click me</button>
    </div>
  );
}
```

### After

```tsx
import { useTranslations } from 'hasyx/lib/i18n/hook';

export function OldComponent() {
  const t = useTranslations('welcome');

  return (
    <div>
      <h1>{t('title')}</h1>
      <button>{t('clickButton')}</button>
    </div>
  );
}
```

Don't forget to add the translation keys to both `i18n/en.json` and `i18n/ru.json`.

## Best Practices

1. **Use namespaces**: Organize translations by feature or component area
2. **Keep keys descriptive**: Use clear, descriptive key names (e.g., `signInButton` instead of `btn1`)
3. **Maintain consistency**: Keep both language files in sync
4. **Avoid hardcoded strings**: Always use translation keys for user-facing text
5. **Update checklist**: Mark components as migrated in `translations.md`
6. **Test both languages**: Verify translations work in all supported languages

## Adding a New Language

To add support for a new language:

### 1. Create Translation File

Create a new JSON file in the `i18n/` directory:

```bash
cp i18n/en.json i18n/fr.json
```

### 2. Translate Content

Edit `i18n/fr.json` and translate all strings to French.

### 3. Update Configuration

Update `lib/i18n/messages.ts` to include the new locale:

```typescript
import * as fr from '../../i18n/fr.json';

export const i18nMessages = (locale: string = 'en') => {
  switch (locale) {
    case 'en': return en;
    case 'ru': return ru;
    case 'fr': return fr;  // Add new locale
    default: return en;
  }
}
```

### 4. Update Locale Switcher

Update `components/locale-switcher.tsx` to support the new language option.

## Troubleshooting

### Translations Not Updating

If translations aren't updating after changes:

1. Clear Next.js cache: `rm -rf .next`
2. Restart the dev server: `npm run dev`
3. Check that JSON files are valid (no syntax errors)

### Missing Translation Keys

If you see raw translation keys instead of translated text:

1. Verify the key exists in both `en.json` and `ru.json`
2. Check the namespace matches what you're using in `useTranslations()`
3. Ensure JSON structure is correct (proper nesting)

### TypeScript Errors

If you encounter TypeScript errors with translations:

1. Make sure you're importing from the correct path
2. Verify that `next-intl` is installed: `npm install next-intl`
3. Check that the Next.js config includes the i18n plugin

## Implementation Status

All major components have been migrated to use i18n. See `translations.md` for the complete checklist.

## Resources

- [next-intl Documentation](https://next-intl-docs.vercel.app/)
- [Translation Checklist](./translations.md)
- [Next.js Internationalization](https://nextjs.org/docs/advanced-features/i18n-routing)
