"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4324],{84324:(e,a,t)=>{t.r(a),t.d(a,{Renderer:()=>j,default:()=>q,roadmap:()=>w});var l=t(95155),s=t(13853),r=t(49514),o=t(82665),i=t(12115),n=t(50255),c=t(97168),d=t(99840),u=t(89852),m=t(96426),h=t(88893),b=t(56671);let y=(0,t(19946).A)("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var g=t(46292),p=t(35929),v=t(87358);let _=(0,s.A)("cyto"),x=[{selector:"node",style:{"background-color":"var(--foreground)","background-opacity":.6,shape:"circle",width:10,height:10,"border-radius":10,color:"var(--foreground)"}},{selector:"node.roadstep",style:{width:20,height:20,"background-opacity":0,shape:"circle",label:"data(label)","text-valign":"bottom","text-halign":"center","text-margin-y":-17,"text-wrap":"wrap"}},{selector:"node.opened",style:{"background-opacity":0,shape:"rectangle"}},{selector:"node.ghost",style:{opacity:.3,width:5,height:5,label:""}},{selector:"node.github-issue",style:{"background-opacity":0,shape:"round-rectangle",width:30,height:20,label:"data(label)","text-valign":"center","text-halign":"center",color:"white","font-size":"10px","font-weight":"bold","text-outline-width":1,"text-outline-color":"#000"}},{selector:"node.github-issue.closed",style:{"background-color":"#ef4444"}},{selector:"node.github-issue.pull-request",style:{"background-color":"#8b5cf6",shape:"diamond"}},{selector:"edge",style:{width:2,"line-color":"var(--foreground)","target-arrow-color":"var(--foreground)","target-arrow-shape":"triangle","curve-style":"bezier"}},{selector:"edge.required",style:{width:2,"line-color":"var(--foreground)","target-arrow-color":"var(--foreground)","target-arrow-shape":"triangle","curve-style":"bezier"}},{selector:"edge.available",style:{width:2,"line-color":"#888888","target-arrow-color":"#888888","target-arrow-shape":"triangle","curve-style":"bezier","line-style":"dashed !important","line-dash-pattern":[10,5],"line-dash-offset":0}},{selector:"edge.mentioned",style:{width:1,"line-color":"#6b7280","target-arrow-color":"#6b7280","target-arrow-shape":"triangle","curve-style":"bezier","line-style":"solid"}},{selector:"edge.depends_on",style:{width:2,"line-color":"#dc2626","target-arrow-color":"#dc2626","target-arrow-shape":"triangle","curve-style":"bezier","line-style":"solid"}},{selector:"edge.blocks",style:{width:2,"line-color":"#ea580c","target-arrow-color":"#ea580c","target-arrow-shape":"triangle","curve-style":"bezier","line-style":"solid"}},{selector:"edge.related_to",style:{width:1.5,"line-color":"#059669","target-arrow-color":"#059669","target-arrow-shape":"triangle","curve-style":"bezier","line-style":"solid"}},{selector:"edge.duplicates",style:{width:1.5,"line-color":"#7c3aed","target-arrow-color":"#7c3aed","target-arrow-shape":"triangle","curve-style":"bezier","line-style":"solid"}}],w=[{symbol:"\uD83D\uDFE2",name:"nextjs",required:[],available:["cli"]},{symbol:"\uD83D\uDFE2",name:"lib",required:["nextjs"]},{symbol:"\uD83D\uDFE2",name:"cli",required:[]},{symbol:"\uD83D\uDFE2",name:"components Cyto",available:["lib"]},{symbol:"\uD83D\uDFE2",name:"generator-hasyx",required:["class-hasura"],available:["lib"]},{symbol:"\uD83D\uDFE2",name:"migrations",required:["class-hasura"],available:["cli"]},{symbol:"\uD83D\uDFE2",name:"apollo",required:["class-hasura"],available:["lib"]},{symbol:"\uD83D\uDFE2",name:"next-auth",required:["class-hasyx"]},{symbol:"\uD83D\uDFE2",name:"google-auth",required:["next-auth"]},{symbol:"\uD83D\uDFE2",name:"yandex-auth",required:["next-auth"]},{symbol:"\uD83D\uDFE2",name:"vk-auth",required:["next-auth"]},{symbol:"\uD83D\uDFE2",name:"telegram-auth",required:["next-auth"]},{symbol:"\uD83D\uDFE0",name:"telegram-miniapp-auth",required:["next-auth"]},{symbol:"\uD83D\uDFE2",name:"class-hasyx",required:["generator-hasyx","apollo"],available:["lib"]},{symbol:"\uD83D\uDFE2",name:"class-hasura",required:["lib"]},{symbol:"\uD83D\uDFE1",name:"graphql-proxy",required:["next-auth","telegram-miniapp-auth","apollo"]},{symbol:"\uD83D\uDFE0",name:"PWA",required:["server-client"]},{symbol:"\uD83D\uDFE2",name:"server-client",required:["nextjs"],available:["cli"]},{symbol:"\uD83D\uDFE1",name:"auth-jwt",required:[]},{symbol:"\uD83D\uDFE2",name:"client",required:["nextjs"],available:["cli"]},{symbol:"\uD83D\uDFE1",name:"capacitor",required:["auth-jwt","client"]},{symbol:"\uD83D\uDFE1",name:"android",required:["capacitor"],available:["cli"]},{symbol:"\uD83D\uDFE1",name:"ios",required:["capacitor"],available:["cli"]},{symbol:"\uD83D\uDFE1",name:"windows",required:["capacitor"],available:["cli"]},{symbol:"\uD83D\uDFE1",name:"macos",required:["capacitor"],available:["cli"]},{symbol:"\uD83D\uDD34",name:"electron-nextjs-server",required:["server-client"],available:["cli"]},{symbol:"\uD83D\uDFE1",name:"electron",required:["auth-jwt","electron-nextjs-server"]},{symbol:"\uD83D\uDFE1",name:"linux",required:["electron-nextjs-server"],available:["cli"]},{symbol:"\uD83D\uDFE1",name:"chrome-extension",required:["auth-jwt","client"],available:["cli"]},{symbol:"\uD83D\uDD34",name:"vscode-extension",required:["auth-jwt","client"],available:["cli"]}];function f(e){let{open:a,onOpenChange:t,onIssueCreated:s}=e,[r,o]=(0,i.useState)(""),[n,p]=(0,i.useState)(""),[x,w]=(0,i.useState)([]),[f,j]=(0,i.useState)(!1),q=(0,h.Dh)(),k=(0,h.c3)("issues"),C=(0,h.c3)("forms"),N=(0,h.c3)("success"),{data:T=[]}=(0,h.IT)({table:"github_issues",where:{},returning:["labels_data"]}),E=(0,i.useMemo)(()=>{let e=new Map;return T.forEach(a=>{a.labels_data&&Array.isArray(a.labels_data)&&a.labels_data.forEach(a=>{a.name&&a.color&&e.set(a.name,{name:a.name,color:a.color})})}),Array.from(e.values()).map(e=>({value:e.name,label:e.name,color:e.color,icon:y}))},[T]),I=async()=>{if(!r.trim())return void b.oR.error(k("titleRequired"));j(!0);try{_("\uD83D\uDD04 Creating GitHub issue via hasyx.insert...",{title:r,body:n});let e=x.map(e=>{let a=E.find(a=>a.value===e);return{id:0,name:e,color:(null==a?void 0:a.color)||"0366d6",description:null,default:!1,node_id:"",url:""}}),a={title:r.trim(),body:n.trim()||void 0,state:"open",created_at:Date.now(),updated_at:Date.now(),github_id:null,number:null,node_id:"",html_url:"",url:"",repository_owner:v.env.NEXT_PUBLIC_GITHUB_OWNER||"",repository_name:v.env.NEXT_PUBLIC_GITHUB_REPO||"",locked:!1,active_lock_reason:null,comments_count:0,author_association:"NONE",user_data:null,assignee_data:null,assignees_data:[],labels_data:e,milestone_data:null,pull_request_data:null,closed_by_data:null,closed_at:null},l=await q.insert({table:"github_issues",object:a});_("✅ Issue inserted into database:",l),b.oR.success(N("issueCreated")),o(""),p(""),t(!1),s&&s(l)}catch(a){let e=a instanceof Error?a.message:"Unknown error";_("❌ Failed to create GitHub issue:",a),console.error("Create issue error:",a),b.oR.error(k("failedToCreate",{message:e}))}finally{j(!1)}};return(0,l.jsx)(d.lG,{open:a,onOpenChange:t,children:(0,l.jsxs)(d.Cf,{className:"sm:max-w-[500px]",children:[(0,l.jsx)(d.c7,{children:(0,l.jsx)(d.L3,{children:k("createGitHubIssue")})}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("label",{htmlFor:"issue-title",className:"text-sm font-medium",children:[k("title")," *"]}),(0,l.jsx)(u.p,{id:"issue-title",placeholder:C("placeholders.issueTitle"),value:r,onChange:e=>o(e.target.value),disabled:f})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{htmlFor:"issue-labels",className:"text-sm font-medium",children:k("labels")}),(0,l.jsx)(g.K,{options:E,onValueChange:w,defaultValue:x,placeholder:C("placeholders.selectLabels"),variant:"default",animation:.5,maxCount:5,className:"w-full"})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{htmlFor:"issue-body",className:"text-sm font-medium",children:k("description")}),(0,l.jsx)(m.n,{value:n,onChange:p,placeholder:C("placeholders.issueDescription"),minHeight:160,className:"w-full"})]})]}),(0,l.jsxs)(d.Es,{children:[(0,l.jsx)(c.$,{variant:"outline",onClick:()=>{o(""),p(""),w([]),t(!1)},disabled:f,children:(0,h.c3)("actions")("cancel")}),(0,l.jsx)(c.$,{onClick:I,disabled:f||!r.trim(),children:f?k("creating"):k("createIssue")})]})]})})}function j(e){let{roadmap:a}=e;return(0,l.jsxs)(l.Fragment,{children:[a.map(e=>(0,l.jsx)(r.EP,{element:{id:e.name,data:{id:e.name,label:"".concat(e.symbol,"\n").concat(e.name)},classes:["roadstep"]}},e.name)),a.map(e=>(0,l.jsxs)(l.Fragment,{children:[(e.required||[]).map(a=>(0,l.jsx)(r.vh,{element:{id:"".concat(e.name,"-").concat(a),data:{id:"".concat(e.name,"-").concat(a),source:e.name,target:a},classes:["required"]}},"".concat(e.name,"-").concat(a))),(e.available||[]).map(a=>(0,l.jsx)(r.vh,{element:{id:"".concat(e.name,"-").concat(a),data:{id:"".concat(e.name,"-").concat(a),source:e.name,target:a},classes:["available"]}},"".concat(e.name,"-").concat(a)))]}))]})}function q(){let[e,a]=(0,i.useState)(null),[s,d]=(0,i.useState)(!1),[u,m]=(0,i.useState)(!1),{onDrawingComplete:y,cancelDrawing:g}=(0,p.U)(),v=(0,r.uU)(),w=null==v?void 0:v.toggleDrawMode,[j]=(0,i.useState)([{table:"github_issues",where:{},returning:["id","github_id","number","title","body","state","state_reason","locked","comments_count","author_association","user_data","assignee_data","assignees_data","labels_data","milestone_data","repository_owner","repository_name","url","html_url","created_at","updated_at","closed_at"],order_by:[{updated_at:"desc"}]}]),{data:q=[]}=(0,h.IT)({table:"github_issues",where:{},returning:["id","github_id","number","title","body","state","state_reason","locked","comments_count","author_association","user_data","assignee_data","assignees_data","labels_data","milestone_data","repository_owner","repository_name","url","html_url","created_at","updated_at","closed_at"],order_by:[{updated_at:"desc"}]}),k=(0,h.c3)("issues"),C=(0,h.c3)("success"),N=async()=>{d(!0);try{_("\uD83D\uDD04 Starting GitHub issues sync...");let e=await fetch("/api/github/issues",{method:"POST",headers:{"Content-Type":"application/json"}}),a=await e.json();if(!e.ok)throw Error(a.error||"HTTP ".concat(e.status));_("✅ GitHub issues sync completed:",a),b.oR.success(C("issuesSynced",{count:a.synced}))}catch(a){let e=a instanceof Error?a.message:"Unknown error";_("❌ GitHub issues sync failed:",a),console.error("GitHub issues sync error:",a),b.oR.error(k("failedToSync",{message:e}))}finally{d(!1)}},T=(0,i.useCallback)(e=>{_("\uD83C\uDF89 Issue created:",e)},[]),E=(0,i.useCallback)(e=>{t.g&&(t.g.cy=e),e.zoom(1),e.center()},[]),I=(0,i.useMemo)(()=>({name:"klay",nodeDimensionsIncludeLabels:!0,fit:!1,klay:{spacing:40,direction:"LEFT"}}),[]);return(0,l.jsxs)("div",{className:"w-full h-full relative",children:[(0,l.jsxs)(r.S_,{onLoaded:E,buttons:!0,layout:I,leftTop:(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("div",{className:"space-y-4",children:(0,l.jsx)(c.$,{onClick:N,disabled:s,className:"w-full",children:s?k("syncing"):k("sync")})})}),rightTop:(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)(c.$,{onClick:()=>m(!0),className:"w-full",variant:"default",children:["➕ ",k("createIssue")]}),y&&(0,l.jsx)(c.$,{onClick:()=>{g(),null==w||w()},className:"w-full",variant:"destructive",children:k("cancelDrawing")})]})}),children:[(0,l.jsx)(r.Lh,{stylesheet:x}),(0,l.jsx)(o.oX,{queries:j,schema:n,availableIssues:q})]}),(0,l.jsx)(f,{open:u,onOpenChange:m,onIssueCreated:T})]})}}}]);