(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[683],{49853:(e,t,s)=>{Promise.resolve().then(s.bind(s,64472)),Promise.resolve().then(s.bind(s,64384))},64384:(e,t,s)=>{"use strict";s.d(t,{default:()=>e_});var n=s(95155),r=s(55366),i=s(97168),a=s(88482),l=s(34964),c=s(82714),d=s(51154),o=s(19946);let u=(0,o.A)("mail-check",[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8",key:"12jkf8"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]),h=(0,o.A)("mail-warning",[["path",{d:"M22 10.5V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h12.5",key:"e61zoh"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"M20 14v4",key:"1hm744"}],["path",{d:"M20 22v.01",key:"12bgn6"}]]);var x=s(34835),m=s(66766),p=s(12115),v=s(88893),j=s(44293),g=s(99173),f=s(13853);function y(e){var t,s,r,o,p,f;let y=(0,v.Dh)(),b=(0,v.c3)("auth"),w=(0,v.c3)("common");(0,v.c3)("actions");let N=(0,v.c3)("errors"),{data:S,status:k}=(0,v.wV)(),E="loading"===k,C=null==S||null==(t=S.user)?void 0:t.id,{data:_,loading:T,error:A}=(0,v.Rs)({table:"users",where:{id:{_eq:C}},returning:["email_verified"]},{role:"me",skip:!C}),R=null==_||null==(r=_.users)||null==(s=r[0])?void 0:s.email_verified,B=async()=>{y.logout()};return(null==y?void 0:y.userId)&&!E?(0,n.jsxs)(a.Zp,{...e,children:[(0,n.jsxs)(a.aR,{children:[(0,n.jsx)(a.ZB,{children:b("connectedAccounts")}),(0,n.jsx)(a.BT,{children:b("addAccountDescription")})]}),(0,n.jsx)(a.Wu,{children:(0,n.jsxs)(l.tU,{defaultValue:"auth",children:[(0,n.jsxs)(l.j7,{className:"grid w-full grid-cols-2",children:[(0,n.jsx)(l.Xi,{value:"auth",children:"Auth"}),(0,n.jsx)(l.Xi,{value:"accounts",children:b("connectedAccounts")})]}),(0,n.jsxs)(l.av,{value:"auth",className:"mt-4 space-y-4",children:[(0,n.jsxs)("div",{className:"grid w-full items-center gap-2",children:[(0,n.jsx)(c.J,{children:"Client Session Status"}),(0,n.jsxs)("div",{className:"flex items-center space-x-2 flex-wrap",children:[C&&(0,n.jsxs)("span",{className:"flex items-center",children:[T&&(0,n.jsx)(d.A,{className:"mr-2 h-4 w-4 animate-spin"}),A&&(0,n.jsx)("span",{className:"text-xs text-red-500",title:A.message,children:N("unknown")}),!T&&!A&&R&&(0,n.jsxs)("span",{title:"Email verified at ".concat(new Date(R).toLocaleString()),className:"mr-2 px-2 py-0.5 rounded text-xs bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200 flex items-center",children:[(0,n.jsx)(u,{className:"mr-1 h-3 w-3"})," ",w("yes")]}),!T&&!A&&!R&&(0,n.jsxs)("span",{title:N("unknown"),className:"mr-2 px-2 py-0.5 rounded text-xs bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200 flex items-center",children:[(0,n.jsx)(h,{className:"mr-1 h-3 w-3"})," ",w("no")]})]}),(null==S||null==(o=S.user)?void 0:o.image)&&(0,n.jsx)(m.default,{src:null==S?void 0:S.user.image,alt:(null==S?void 0:S.user.name)||"User avatar",width:24,height:24,className:"rounded-full"}),(0,n.jsxs)("span",{children:[(null==S||null==(p=S.user)?void 0:p.name)||(null==S||null==(f=S.user)?void 0:f.email)," ",(null==S?void 0:S.provider)?"(".concat(S.provider,")"):""]})]})]}),(0,n.jsxs)("div",{className:"grid w-full items-center gap-2",children:[(0,n.jsx)(c.J,{children:b("signOut")}),(0,n.jsxs)(i.$,{onClick:B,disabled:E,children:[(0,n.jsx)(x.A,{className:"mr-2 h-4 w-4"})," ",b("signOut")]})]})]}),(0,n.jsx)(l.av,{value:"accounts",className:"mt-4",children:(0,n.jsx)("div",{className:"max-h-[400px] overflow-y-auto",children:(0,n.jsx)(g.b,{userId:C})})})]})})]}):(0,n.jsxs)(a.Zp,{...e,children:[(0,n.jsxs)(a.aR,{children:[(0,n.jsx)(a.ZB,{children:b("connectedAccounts")}),(0,n.jsx)(a.BT,{children:b("signInToYourAccount")})]}),(0,n.jsxs)(a.Wu,{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"grid w-full items-center gap-2",children:[(0,n.jsx)(c.J,{children:b("signInToYourAccount")}),E&&(0,n.jsxs)("p",{className:"flex items-center",children:[(0,n.jsx)(d.A,{className:"mr-2 h-4 w-4 animate-spin"}),w("loading")]}),!S&&!E&&(0,n.jsx)("p",{children:b("signIn")})]}),(0,n.jsxs)("div",{className:"grid w-full items-center gap-2",children:[(0,n.jsx)(c.J,{children:b("signIn")}),(0,n.jsx)(j.z,{})]})]})]})}(0,f.A)("auth:actions-card");var b=s(89852),w=Object.defineProperty,N=Object.defineProperties,S=Object.getOwnPropertyDescriptors,k=Object.getOwnPropertySymbols,E=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable,_=(e,t,s)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,T=(e,t)=>{for(var s in t||(t={}))E.call(t,s)&&_(e,s,t[s]);if(k)for(var s of k(t))C.call(t,s)&&_(e,s,t[s]);return e},A=(e,t)=>N(e,S(t)),R=(e,t)=>{var s={};for(var n in e)E.call(e,n)&&0>t.indexOf(n)&&(s[n]=e[n]);if(null!=e&&k)for(var n of k(e))0>t.indexOf(n)&&C.call(e,n)&&(s[n]=e[n]);return s},B=p.createContext({}),I=p.forwardRef((e,t)=>{var s,n,r,i,a,{value:l,onChange:c,maxLength:d,textAlign:o="left",pattern:u,placeholder:h,inputMode:x="numeric",onComplete:m,pushPasswordManagerStrategy:v="increase-width",pasteTransformer:j,containerClassName:g,noScriptCSSFallback:f=P,render:y,children:b}=e,w=R(e,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]);let[N,S]=p.useState("string"==typeof w.defaultValue?w.defaultValue:""),k=null!=l?l:N,E=function(e){let t=p.useRef();return p.useEffect(()=>{t.current=e}),t.current}(k),C=p.useCallback(e=>{null==c||c(e),S(e)},[c]),_=p.useMemo(()=>u?"string"==typeof u?new RegExp(u):u:null,[u]),I=p.useRef(null),Z=p.useRef(null),M=p.useRef({value:k,onChange:C,isIOS:"undefined"!=typeof window&&(null==(n=null==(s=null==window?void 0:window.CSS)?void 0:s.supports)?void 0:n.call(s,"-webkit-touch-callout","none"))}),O=p.useRef({prev:[null==(r=I.current)?void 0:r.selectionStart,null==(i=I.current)?void 0:i.selectionEnd,null==(a=I.current)?void 0:a.selectionDirection]});p.useImperativeHandle(t,()=>I.current,[]),p.useEffect(()=>{let e=I.current,t=Z.current;if(!e||!t)return;function s(){if(document.activeElement!==e){$(null),G(null);return}let t=e.selectionStart,s=e.selectionEnd,n=e.selectionDirection,r=e.maxLength,i=e.value,a=O.current.prev,l=-1,c=-1,d;if(0!==i.length&&null!==t&&null!==s){let e=t===s,n=t===i.length&&i.length<r;if(e&&!n){if(0===t)l=0,c=1,d="forward";else if(t===r)l=t-1,c=t,d="backward";else if(r>1&&i.length>1){let e=0;if(null!==a[0]&&null!==a[1]){d=t<a[1]?"backward":"forward";let s=a[0]===a[1]&&a[0]<r;"backward"!==d||s||(e=-1)}l=e+t,c=e+t+1}}-1!==l&&-1!==c&&l!==c&&I.current.setSelectionRange(l,c,d)}let o=-1!==l?l:t,u=-1!==c?c:s,h=null!=d?d:n;$(o),G(u),O.current.prev=[o,u,h]}if(M.current.value!==e.value&&M.current.onChange(e.value),O.current.prev=[e.selectionStart,e.selectionEnd,e.selectionDirection],document.addEventListener("selectionchange",s,{capture:!0}),s(),document.activeElement===e&&F(!0),!document.getElementById("input-otp-style")){let e=document.createElement("style");if(e.id="input-otp-style",document.head.appendChild(e),e.sheet){let t="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";W(e.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),W(e.sheet,`[data-input-otp]:autofill { ${t} }`),W(e.sheet,`[data-input-otp]:-webkit-autofill { ${t} }`),W(e.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),W(e.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let n=()=>{t&&t.style.setProperty("--root-height",`${e.clientHeight}px`)};n();let r=new ResizeObserver(n);return r.observe(e),()=>{document.removeEventListener("selectionchange",s,{capture:!0}),r.disconnect()}},[]);let[D,J]=p.useState(!1),[L,F]=p.useState(!1),[q,$]=p.useState(null),[H,G]=p.useState(null);p.useEffect(()=>{!function(e){setTimeout(e,0),setTimeout(e,10),setTimeout(e,50)}(()=>{var e,t,s,n;null==(e=I.current)||e.dispatchEvent(new Event("input"));let r=null==(t=I.current)?void 0:t.selectionStart,i=null==(s=I.current)?void 0:s.selectionEnd,a=null==(n=I.current)?void 0:n.selectionDirection;null!==r&&null!==i&&($(r),G(i),O.current.prev=[r,i,a])})},[k,L]),p.useEffect(()=>{void 0!==E&&k!==E&&E.length<d&&k.length===d&&(null==m||m(k))},[d,m,E,k]);let U=function({containerRef:e,inputRef:t,pushPasswordManagerStrategy:s,isFocused:n}){let[r,i]=p.useState(!1),[a,l]=p.useState(!1),[c,d]=p.useState(!1),o=p.useMemo(()=>"none"!==s&&("increase-width"===s||"experimental-no-flickering"===s)&&r&&a,[r,a,s]),u=p.useCallback(()=>{let n=e.current,r=t.current;if(!n||!r||c||"none"===s)return;let a=n.getBoundingClientRect().left+n.offsetWidth,l=n.getBoundingClientRect().top+n.offsetHeight/2;0===document.querySelectorAll('[data-lastpass-icon-root],com-1password-button,[data-dashlanecreated],[style$="2147483647 !important;"]').length&&document.elementFromPoint(a-18,l)===n||(i(!0),d(!0))},[e,t,c,s]);return p.useEffect(()=>{let t=e.current;if(!t||"none"===s)return;function n(){l(window.innerWidth-t.getBoundingClientRect().right>=40)}n();let r=setInterval(n,1e3);return()=>{clearInterval(r)}},[e,s]),p.useEffect(()=>{let e=n||document.activeElement===t.current;if("none"===s||!e)return;let r=setTimeout(u,0),i=setTimeout(u,2e3),a=setTimeout(u,5e3),l=setTimeout(()=>{d(!0)},6e3);return()=>{clearTimeout(r),clearTimeout(i),clearTimeout(a),clearTimeout(l)}},[t,n,s,u]),{hasPWMBadge:r,willPushPWMBadge:o,PWM_BADGE_SPACE_WIDTH:"40px"}}({containerRef:Z,inputRef:I,pushPasswordManagerStrategy:v,isFocused:L}),X=p.useCallback(e=>{let t=e.currentTarget.value.slice(0,d);if(t.length>0&&_&&!_.test(t))return void e.preventDefault();"string"==typeof E&&t.length<E.length&&document.dispatchEvent(new Event("selectionchange")),C(t)},[d,C,E,_]),V=p.useCallback(()=>{var e;if(I.current){let t=Math.min(I.current.value.length,d-1),s=I.current.value.length;null==(e=I.current)||e.setSelectionRange(t,s),$(t),G(s)}F(!0)},[d]),z=p.useCallback(e=>{var t,s;let n=I.current;if(!j&&(!M.current.isIOS||!e.clipboardData||!n))return;let r=e.clipboardData.getData("text/plain"),i=j?j(r):r;e.preventDefault();let a=null==(t=I.current)?void 0:t.selectionStart,l=null==(s=I.current)?void 0:s.selectionEnd,c=(a!==l?k.slice(0,a)+i+k.slice(l):k.slice(0,a)+i+k.slice(a)).slice(0,d);if(c.length>0&&_&&!_.test(c))return;n.value=c,C(c);let o=Math.min(c.length,d-1),u=c.length;n.setSelectionRange(o,u),$(o),G(u)},[d,C,_,k]),Q=p.useMemo(()=>({position:"relative",cursor:w.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[w.disabled]),K=p.useMemo(()=>({position:"absolute",inset:0,width:U.willPushPWMBadge?`calc(100% + ${U.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:U.willPushPWMBadge?`inset(0 ${U.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:o,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[U.PWM_BADGE_SPACE_WIDTH,U.willPushPWMBadge,o]),Y=p.useMemo(()=>p.createElement("input",A(T({autoComplete:w.autoComplete||"one-time-code"},w),{"data-input-otp":!0,"data-input-otp-placeholder-shown":0===k.length||void 0,"data-input-otp-mss":q,"data-input-otp-mse":H,inputMode:x,pattern:null==_?void 0:_.source,"aria-placeholder":h,style:K,maxLength:d,value:k,ref:I,onPaste:e=>{var t;z(e),null==(t=w.onPaste)||t.call(w,e)},onChange:X,onMouseOver:e=>{var t;J(!0),null==(t=w.onMouseOver)||t.call(w,e)},onMouseLeave:e=>{var t;J(!1),null==(t=w.onMouseLeave)||t.call(w,e)},onFocus:e=>{var t;V(),null==(t=w.onFocus)||t.call(w,e)},onBlur:e=>{var t;F(!1),null==(t=w.onBlur)||t.call(w,e)}})),[X,V,z,x,K,d,H,q,w,null==_?void 0:_.source,k]),ee=p.useMemo(()=>({slots:Array.from({length:d}).map((e,t)=>{var s;let n=L&&null!==q&&null!==H&&(q===H&&t===q||t>=q&&t<H),r=void 0!==k[t]?k[t]:null;return{char:r,placeholderChar:void 0!==k[0]?null:null!=(s=null==h?void 0:h[t])?s:null,isActive:n,hasFakeCaret:n&&null===r}}),isFocused:L,isHovering:!w.disabled&&D}),[L,D,d,H,q,w.disabled,k]),et=p.useMemo(()=>y?y(ee):p.createElement(B.Provider,{value:ee},b),[b,ee,y]);return p.createElement(p.Fragment,null,null!==f&&p.createElement("noscript",null,p.createElement("style",null,f)),p.createElement("div",{ref:Z,"data-input-otp-container":!0,style:Q,className:g},et,p.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},Y)))});function W(e,t){try{e.insertRule(t)}catch(e){console.error("input-otp could not insert CSS rule:",t)}}I.displayName="Input";var P=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`,Z=s(53999);function M(e){let{className:t,containerClassName:s,...r}=e;return(0,n.jsx)(I,{"data-slot":"input-otp",containerClassName:(0,Z.cn)("flex items-center gap-2 has-disabled:opacity-50",s),className:(0,Z.cn)("disabled:cursor-not-allowed",t),...r})}function O(e){let{className:t,...s}=e;return(0,n.jsx)("div",{"data-slot":"input-otp-group",className:(0,Z.cn)("flex items-center",t),...s})}function D(e){var t;let{index:s,className:r,...i}=e,a=p.useContext(B),{char:l,hasFakeCaret:c,isActive:d}=null!=(t=null==a?void 0:a.slots[s])?t:{};return(0,n.jsxs)("div",{"data-slot":"input-otp-slot","data-active":d,className:(0,Z.cn)("data-[active=true]:border-ring data-[active=true]:ring-ring/50 data-[active=true]:aria-invalid:ring-destructive/20 dark:data-[active=true]:aria-invalid:ring-destructive/40 aria-invalid:border-destructive data-[active=true]:aria-invalid:border-destructive dark:bg-input/30 border-input relative flex h-9 w-9 items-center justify-center border-y border-r text-sm shadow-xs transition-all outline-none first:rounded-l-md first:border-l last:rounded-r-md data-[active=true]:z-10 data-[active=true]:ring-[3px]",r),...i,children:[l,c&&(0,n.jsx)("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:(0,n.jsx)("div",{className:"animate-caret-blink bg-foreground h-4 w-px duration-1000"})})]})}let J=(0,o.A)("key-round",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);var L=s(12108),F=s(90539);function q(e){let t=(0,v.c3)("auth"),s=(0,v.c3)("common"),r=(0,v.c3)("forms");(0,F.$)();let[d,o]=(0,p.useState)("email"),[u,h]=(0,p.useState)(""),[x,m]=(0,p.useState)(""),[j,g]=(0,p.useState)(""),[f,y]=(0,p.useState)(null),[w,N]=(0,p.useState)(null),[S,k]=(0,p.useState)(!1),[E,C]=(0,p.useState)(null),[_,T]=(0,p.useState)(""),A=async()=>{y(null),N(null),k(!0);try{let e="email"===d?u:x,t=await fetch("/api/auth/credentials/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:d,identifier:e})}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to start");C(s.attemptId),N("Code sent. Enter it below.")}catch(e){console.error("Credentials sign-in error:",e),y("An error occurred during sign-in")}finally{k(!1)}},R=async e=>{if(E&&6===e.length){k(!0);try{let t=await fetch("/api/auth/credentials/verify",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({attemptId:E,code:e,password:j})}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to verify");let n=await (0,L.signIn)("credentials",{redirect:!1,userId:s.userId});(null==n?void 0:n.error)?y(n.error):window.location.reload()}catch(e){console.error(e),y((null==e?void 0:e.message)||"Verification failed")}finally{k(!1)}}};return(0,n.jsxs)(a.Zp,{...e,children:[(0,n.jsxs)(a.aR,{children:[(0,n.jsxs)(a.ZB,{className:"text-2xl flex items-center gap-2",children:[(0,n.jsx)(J,{className:"h-6 w-6"}),t("signIn")]}),(0,n.jsx)(a.BT,{children:t("signInToYourAccount")})]}),(0,n.jsx)(a.Wu,{children:(0,n.jsxs)("div",{className:"grid gap-4",children:[(0,n.jsxs)(l.tU,{value:d,onValueChange:e=>o(e),children:[(0,n.jsxs)(l.j7,{className:"grid w-full grid-cols-2",children:[(0,n.jsx)(l.Xi,{value:"email",children:"Email"}),(0,n.jsx)(l.Xi,{value:"phone",children:"Phone"})]}),(0,n.jsxs)(l.av,{value:"email",className:"mt-4 grid gap-2",children:[(0,n.jsx)(c.J,{htmlFor:"email",children:r("labels.email")}),(0,n.jsx)(b.p,{id:"email",type:"email",placeholder:"m@example.com",value:u,onChange:e=>h(e.target.value),disabled:S||!!E,required:!0})]}),(0,n.jsxs)(l.av,{value:"phone",className:"mt-4 grid gap-2",children:[(0,n.jsx)(c.J,{htmlFor:"phone",children:"Phone"}),(0,n.jsx)(b.p,{id:"phone",type:"tel",placeholder:"+15551234567",value:x,onChange:e=>m(e.target.value),disabled:S||!!E,required:!0})]})]}),(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)(c.J,{htmlFor:"password",children:r("labels.password")})}),(0,n.jsx)(b.p,{id:"password",type:"password",value:j,onChange:e=>g(e.target.value),disabled:S||!!E,required:!0})]}),E?(0,n.jsxs)("div",{className:"grid gap-2",children:[(0,n.jsx)(c.J,{children:"Enter verification code"}),(0,n.jsx)(M,{maxLength:6,value:_,onChange:T,onComplete:R,children:(0,n.jsxs)(O,{children:[(0,n.jsx)(D,{index:0}),(0,n.jsx)(D,{index:1}),(0,n.jsx)(D,{index:2}),(0,n.jsx)(D,{index:3}),(0,n.jsx)(D,{index:4}),(0,n.jsx)(D,{index:5})]})})]}):null,f&&(0,n.jsx)("div",{className:"text-red-500 text-sm",children:f}),w&&(0,n.jsx)("div",{className:"text-blue-500 text-sm",children:w}),!E&&(0,n.jsx)(i.$,{type:"button",className:"w-full",onClick:A,disabled:S,children:S?s("loading"):"Send code"})]})})]})}var $=s(5196);let H=(0,o.A)("clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);function G(e){let{value:t,language:s}=e,[r,a]=(0,p.useState)(!1);return(0,n.jsxs)("div",{className:"relative rounded-md border bg-muted p-4 font-mono text-sm overflow-x-auto",children:[(0,n.jsx)(i.$,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 h-6 w-6",onClick:()=>{navigator.clipboard.writeText(t).then(()=>{a(!0),setTimeout(()=>a(!1),2e3)})},"aria-label":"Copy code",children:r?(0,n.jsx)($.A,{className:"h-4 w-4 text-green-500"}):(0,n.jsx)(H,{className:"h-4 w-4"})}),(0,n.jsx)("pre",{children:(0,n.jsx)("code",{children:t})})]})}var U=s(87251),X=s(53904),V=s(50339);let z=(0,f.A)("auth:get-status");function Q(){let e,t=(0,v.c3)("authStatus"),[s,r]=(0,p.useState)("idle"),[l,d]=(0,p.useState)(null),[o,u]=(0,p.useState)(null),h=async()=>{z("GET /api/auth: Fetching status..."),r("loading"),u(null),d(null);try{let e=await fetch((0,V.OZ)(window.location.protocol,V.H$,"/api/auth"));if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));let t=await e.json();z("GET /api/auth: Fetch successful",t),d(t),r("success")}catch(e){z("GET /api/auth: Fetch error:",e),u(e),r("error")}};return(0,p.useEffect)(()=>{h()},[]),e="loading"===s?"connecting":"error"===s?"error":"success"===s&&(null==l?void 0:l.authenticated)?"connected":"idle",(0,n.jsxs)(a.Zp,{children:[(0,n.jsx)(a.aR,{children:(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(a.ZB,{className:"text-lg",children:t("get.title")}),(0,n.jsx)(a.BT,{children:t("get.description")})]}),(0,n.jsx)(i.$,{variant:"ghost",size:"icon",onClick:h,disabled:"loading"===s,"aria-label":"Refresh GET status",children:(0,n.jsx)(X.A,{className:"h-4 w-4 ".concat("loading"===s?"animate-spin":"")})})]})}),(0,n.jsxs)(a.Wu,{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(c.J,{children:t("get.requestStatus")}),(0,n.jsx)(U.n,{status:e,label:"success"!==s||(null==l?void 0:l.authenticated)?void 0:t("get.successUnauth"),error:o})]}),"success"===s&&(null==l?void 0:l.authenticated)&&(0,n.jsxs)("div",{children:[(0,n.jsx)(c.J,{children:t("get.decodedJwt")}),(0,n.jsx)(G,{value:JSON.stringify(l.token,null,2)})]}),"error"===s&&(0,n.jsxs)("div",{children:[(0,n.jsx)(c.J,{className:"text-red-500",children:t("get.fetchError")}),(0,n.jsx)(G,{value:(null==o?void 0:o.message)||t("unknownFetchError")})]}),"success"===s&&!(null==l?void 0:l.authenticated)&&(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:t("get.notAuthenticated")})]})]})}let K=(0,f.A)("auth:socket-status");function Y(){let e,t=(0,v.c3)("authStatus"),[s,r]=(0,p.useState)("idle"),[i,l]=(0,p.useState)(null),[d,o]=(0,p.useState)(null),u=(0,p.useRef)(null),h=()=>{let e=(0,V.OZ)("ws","https://hasyx.deep.foundation","/api/auth");K("Attempting to connect WebSocket: ".concat(e)),r("connecting"),o(null),l(null),u.current&&u.current.readyState!==WebSocket.CLOSED&&(K("Closing previous WebSocket connection."),u.current.close());try{u.current=new WebSocket(e),u.current.onopen=()=>{K("WebSocket connection opened."),r("connected")},u.current.onmessage=e=>{try{let t=JSON.parse(e.data.toString());K("WebSocket message received:",t),"auth_status"===t.type?l(t):"auth_error"===t.type&&(o(Error(t.message||"Authentication error from server")),r("error"))}catch(t){K("Error parsing WebSocket message:",t,"Raw data:",e.data),o(Error("Failed to parse message from server")),r("error")}},u.current.onerror=e=>{K("WebSocket error:",e),o(Error("WebSocket connection error")),r("error")},u.current.onclose=e=>{K("WebSocket connection closed. Code: ".concat(e.code,", Reason: ").concat(e.reason)),"error"!==s&&r("idle")}}catch(e){K("Failed to initialize WebSocket:",e),o(e),r("error")}};return(0,p.useEffect)(()=>(h(),()=>{u.current&&(K("Closing WebSocket connection on component unmount."),u.current.close())}),[]),e="connecting"===s?"connecting":"error"===s?"error":"connected"===s?"connected":"idle",(0,n.jsxs)(a.Zp,{children:[(0,n.jsx)(a.aR,{children:(0,n.jsx)("div",{className:"flex justify-between items-center",children:(0,n.jsxs)("div",{children:[(0,n.jsx)(a.ZB,{className:"text-lg",children:t("ws.title")}),(0,n.jsx)(a.BT,{children:t("ws.description")})]})})}),(0,n.jsxs)(a.Wu,{className:"space-y-2",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(c.J,{children:t("ws.connection")}),(0,n.jsx)(U.n,{status:e,error:d})]}),"connected"===s&&i&&(0,n.jsxs)("div",{children:[(0,n.jsx)(c.J,{children:t("ws.authStatus")}),(0,n.jsx)("p",{className:"text-sm ".concat(i.authenticated?"text-green-600":"text-red-600"),children:t(i.authenticated?"authenticated":"notAuthenticated")})]}),"connected"===s&&(null==i?void 0:i.authenticated)&&(0,n.jsxs)("div",{children:[(0,n.jsx)(c.J,{children:t("ws.userData")}),(0,n.jsx)(G,{value:JSON.stringify({userId:i.userId,token:i.token},null,2)})]}),"error"===s&&(0,n.jsxs)("div",{children:[(0,n.jsx)(c.J,{className:"text-red-500",children:t("ws.connError")}),(0,n.jsx)(G,{value:(null==d?void 0:d.message)||t("unknownWsError")})]}),"idle"===s&&(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:t("ws.idle")})]})]})}function ee(){let e=(0,v.Dh)(),t=(0,v.c3)("session");return(0,n.jsxs)(a.Zp,{children:[(0,n.jsxs)(a.aR,{children:[(0,n.jsx)(a.ZB,{className:"text-lg",children:t("hasyx.title")}),(0,n.jsx)(a.BT,{children:t("hasyx.description")})]}),(0,n.jsx)(a.Wu,{children:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-medium mb-2",children:t("hasyx.userId")}),(0,n.jsx)(G,{value:e.userId||"null"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-medium mb-2",children:t("hasyx.user")}),(0,n.jsx)(G,{value:JSON.stringify(e.user,null,2)})]})]})})]})}function et(e){let{serverSession:t}=e,s=(0,v.c3)("session");return(0,n.jsxs)(a.Zp,{children:[(0,n.jsxs)(a.aR,{children:[(0,n.jsx)(a.ZB,{children:s("title")}),(0,n.jsx)(a.BT,{children:s("description")})]}),(0,n.jsx)(a.Wu,{children:(0,n.jsxs)(l.tU,{defaultValue:"ssr",children:[(0,n.jsxs)(l.j7,{className:"grid w-full grid-cols-4",children:[(0,n.jsx)(l.Xi,{value:"ssr",children:s("tabs.ssr")}),(0,n.jsx)(l.Xi,{value:"get",children:s("tabs.get")}),(0,n.jsx)(l.Xi,{value:"socket",children:s("tabs.socket")}),(0,n.jsx)(l.Xi,{value:"hasyx",children:s("tabs.hasyx")})]}),(0,n.jsx)(l.av,{value:"ssr",className:"mt-4",children:(0,n.jsxs)(a.Zp,{children:[(0,n.jsxs)(a.aR,{children:[(0,n.jsx)(a.ZB,{className:"text-lg",children:s("ssr.title")}),(0,n.jsx)(a.BT,{children:s("ssr.description")})]}),(0,n.jsx)(a.Wu,{children:t?(0,n.jsx)(G,{value:JSON.stringify(t,null,2)}):(0,n.jsx)("p",{children:s("ssr.empty")})})]})}),(0,n.jsx)(l.av,{value:"get",className:"mt-4",children:(0,n.jsx)(Q,{})}),(0,n.jsx)(l.av,{value:"socket",className:"mt-4",children:(0,n.jsx)(Y,{})}),(0,n.jsx)(l.av,{value:"hasyx",className:"mt-4",children:(0,n.jsx)(ee,{})})]})})]})}var es=s(56671);function en(){var e;let t=(0,v.Dh)(),{data:s}=(0,v.wV)();(0,F.$)();let r=(0,v.c3)("jwt");(0,v.c3)("common");let[d,o]=(0,p.useState)(""),[u,h]=(0,p.useState)(null),[x,m]=(0,p.useState)(!1),[j,g]=(0,p.useState)(!1);(0,p.useEffect)(()=>{let e=()=>{h(localStorage.getItem("nextauth_jwt"))};e();let t=()=>e();return window.addEventListener("storage",t),()=>{window.removeEventListener("storage",t)}},[]);let f=async()=>{if(!s)return void es.oR.error(r("needAuth"));g(!0);try{let e=await t.jwt();e?(await navigator.clipboard.writeText(e),es.oR.success(r("copied"))):es.oR.error(r("failedGet"))}catch(e){es.oR.error(r("errorGetting"))}finally{g(!1)}};return(0,n.jsxs)(a.Zp,{children:[(0,n.jsxs)(a.aR,{children:[(0,n.jsx)(a.ZB,{children:r("title")}),(0,n.jsx)(a.BT,{children:r("description")})]}),(0,n.jsx)(a.Wu,{children:(0,n.jsxs)(l.tU,{defaultValue:"login",children:[(0,n.jsxs)(l.j7,{className:"grid w-full grid-cols-3",children:[(0,n.jsx)(l.Xi,{value:"login",children:r("tabs.login")}),(0,n.jsx)(l.Xi,{value:"generate",children:r("tabs.generate")}),(0,n.jsx)(l.Xi,{value:"current",children:r("tabs.current")})]}),(0,n.jsx)(l.av,{value:"login",className:"mt-4",children:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(c.J,{htmlFor:"jwt-input",children:r("jwtToken")}),(0,n.jsx)(b.p,{id:"jwt-input",type:"text",placeholder:r("placeholder"),value:d,onChange:e=>o(e.target.value),className:"mt-2"})]}),(0,n.jsx)(i.$,{onClick:()=>{if(!d.trim())return void es.oR.error(r("enterToken"));try{localStorage.setItem("nextauth_jwt",d.trim()),h(d.trim()),es.oR.success(r("tokenSaved")),o("")}catch(e){es.oR.error(r("errorSaving"))}},disabled:x||!d.trim(),className:"w-full",children:x?r("loggingIn"):r("loginWithJwt")}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:r("enterJwtToLogin")})]})}),(0,n.jsx)(l.av,{value:"generate",className:"mt-4",children:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-medium mb-2",children:r("authStatus")}),(0,n.jsx)(G,{value:s?r("authenticated"):r("notAuthenticated")})]}),s&&(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-medium mb-2",children:r("user")}),(0,n.jsx)(G,{value:(null==(e=s.user)?void 0:e.email)||r("notSpecified")})]}),(0,n.jsx)(i.$,{onClick:f,disabled:j||!s,className:"w-full",children:j?r("generating"):r("copyJwt")}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:r("copyDescription")})]})}),(0,n.jsx)(l.av,{value:"current",className:"mt-4",children:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-sm font-medium mb-2",children:r("jwtLocalStorage")}),(0,n.jsx)(G,{value:u||r("notFound")})]}),u&&(0,n.jsx)(i.$,{onClick:()=>{localStorage.removeItem("nextauth_jwt"),h(null),es.oR.success(r("removed"))},variant:"destructive",className:"w-full",children:r("clearJwt")}),(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:r("updatedAutomatically")})]})})]})})]})}var er=s(49765);let ei=(0,f.A)("hooks:connection");function ea(e){let t=function(){let[e,t]=(0,p.useState)("connecting");return(0,p.useEffect)(()=>{let e=!0;return(async()=>{try{e&&t("connecting");let s=(0,er.KU)(),n=await (0,er.jo)(s);if(!e)return;n?(ei("hooks:connection","✅ Connected to Hasura GraphQL endpoint"),t("connected")):(ei("hooks:connection","❌ Failed to connect to Hasura GraphQL endpoint"),t("error"))}catch(s){e&&(ei("hooks:connection","❌ Connection error:",s),t("error"))}})(),()=>{e=!1}},[]),e}(),s=(0,v.c3)("hasura");return(0,v.c3)("common"),(0,n.jsxs)(a.Zp,{...e,children:[(0,n.jsx)(a.aR,{children:(0,n.jsxs)(a.ZB,{children:[s("title")," ",(0,n.jsx)(U.n,{status:t})]})}),(0,n.jsx)(a.Wu,{children:(0,n.jsxs)("div",{className:"grid w-full items-center gap-4",children:[(0,n.jsx)(c.J,{children:s("requiredEnv")}),(0,n.jsx)(a.BT,{children:s("public")}),(0,n.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,n.jsx)(c.J,{htmlFor:"NEXT_PUBLIC_HASURA_GRAPHQL_URL",children:"NEXT_PUBLIC_HASURA_GRAPHQL_URL"}),(0,n.jsx)(b.p,{id:"NEXT_PUBLIC_HASURA_GRAPHQL_URL",disabled:!0,value:"https://hasura.deep.foundation/v1/graphql",className:""})]})]})})]})}(0,f.A)("hasura-card");var el=s(15933),ec=s(36112),ed=s(85879),eo=s(42016);function eu(){let e=(0,el._)(["\nquery CheckConnection {\n  users(limit: 1) { id }\n}\n"]);return eu=function(){return e},e}function eh(){let e=(0,el._)(["\nsubscription CheckConnection {\n  users(limit: 1) { id }\n}\n"]);return eh=function(){return e},e}let ex=(0,f.A)("proxy-card"),em=(0,ec.J1)(eu()),ep=(0,ec.J1)(eh());function ev(e){let t=(0,v.c3)("proxy"),[s,r]=(0,p.useState)("connecting"),[i,l]=(0,p.useState)("connecting"),[d,o]=(0,p.useState)("connecting");(0,p.useEffect)(()=>{ex("Checking GET /api/graphql"),fetch("/api/graphql").then(async e=>{if(e.ok)if("ok"===(await e.json()).status)ex("GET /api/graphql successful"),r("connected");else throw Error("Invalid GET response format");else throw Error("GET request failed with status ".concat(e.status))}).catch(e=>{ex("Error checking GET /api/graphql:",e),r("error")})},[]);let{loading:u,error:h,data:x}=(0,ed.IT)(em),{loading:m,error:j,data:g}=(0,eo.R)(ep);return(0,p.useEffect)(()=>{u?l("connecting"):h?(ex("Error checking POST via useQuery:",h),l("error")):(null==x?void 0:x.users)?(ex("POST check via useQuery successful"),l("connected")):(ex("POST check via useQuery returned unexpected data:",x),l("error"))},[u,h,x]),(0,p.useEffect)(()=>{m?o("connecting"):j?(ex("Error checking SOCKET via useSubscription:",j),o("error")):(null==g?void 0:g.users)&&(ex("SOCKET check via useSubscription successful (data received)"),o("connected"))},[m,j,g]),(0,n.jsxs)(a.Zp,{...e,children:[(0,n.jsx)(a.aR,{children:(0,n.jsx)(a.ZB,{children:t("title")})}),(0,n.jsx)(a.Wu,{children:(0,n.jsxs)("div",{className:"grid w-full items-center gap-4 mt-4",children:[(0,n.jsxs)(c.J,{children:[t("get")," ",(0,n.jsx)(U.n,{status:s})]}),(0,n.jsxs)(c.J,{children:[t("post")," ",(0,n.jsx)(U.n,{status:i})]}),(0,n.jsxs)(c.J,{children:[t("socket")," ",(0,n.jsx)(U.n,{status:d})]})]})})]})}let ej=(0,o.A)("terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]);var eg=s(49026);let ef=(0,f.A)("users-query");function ey(){let e=(0,v.c3)("usersList"),{data:t=[],loading:s,error:r}=(0,v.IT)({table:"users",limit:5,returning:["id","created_at","updated_at"]},{role:"anonymous"});return ef("Query state:",{loading:s,error:r,data:t}),(0,n.jsxs)(a.Zp,{children:[(0,n.jsxs)(a.aR,{children:[(0,n.jsx)(a.ZB,{className:"text-lg",children:e("query.title")}),(0,n.jsx)(a.BT,{children:e("query.description")})]}),(0,n.jsxs)(a.Wu,{children:[s&&(0,n.jsxs)("div",{className:"flex items-center justify-center p-4",children:[(0,n.jsx)(d.A,{className:"mr-2 h-5 w-5 animate-spin"})," ",e("loading")]}),r&&(0,n.jsxs)(eg.Fc,{variant:"destructive",children:[(0,n.jsx)(ej,{className:"h-4 w-4"}),(0,n.jsx)(eg.XL,{children:e("query.errorTitle")}),(0,n.jsx)(eg.TN,{children:r.message||e("query.errorDescription")})]}),!s&&!r&&!!(null==t?void 0:t.length)&&(0,n.jsx)("ul",{className:"space-y-2",children:t.map(t=>(0,n.jsxs)("li",{className:"text-sm p-2 border rounded bg-muted/40",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"ID:"})," ",t.id]}),t.name&&(0,n.jsxs)("p",{children:[(0,n.jsxs)("strong",{children:[e("name"),":"]})," ",t.name]}),t.email&&(0,n.jsxs)("p",{children:[(0,n.jsxs)("strong",{children:[e("email"),":"]})," ",t.email]})]},t.id))}),!s&&!r&&!(null==t?void 0:t.length)&&(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:e("empty")})]})]})}let eb=(0,f.A)("users-subscription");function ew(){let e=(0,v.c3)("usersList"),{data:t=[],loading:s,error:r}=(0,v.Rs)({table:"users",limit:5,returning:["id","created_at","updated_at"]},{role:"anonymous"});return eb("Subscription state:",{loading:s,error:r,data:t}),(0,n.jsxs)(a.Zp,{children:[(0,n.jsxs)(a.aR,{children:[(0,n.jsx)(a.ZB,{className:"text-lg",children:e("subscription.title")}),(0,n.jsx)(a.BT,{children:e("subscription.description")})]}),(0,n.jsxs)(a.Wu,{children:[s&&(0,n.jsxs)("div",{className:"flex items-center justify-center p-4",children:[(0,n.jsx)(d.A,{className:"mr-2 h-5 w-5 animate-spin"})," ",e("loading")]}),r&&(0,n.jsxs)(eg.Fc,{variant:"destructive",children:[(0,n.jsx)(ej,{className:"h-4 w-4"}),(0,n.jsx)(eg.XL,{children:e("subscription.errorTitle")}),(0,n.jsx)(eg.TN,{children:r.message||e("subscription.errorDescription")})]}),!s&&!r&&!!(null==t?void 0:t.length)&&(0,n.jsx)("ul",{className:"space-y-2",children:null==t?void 0:t.map(t=>(0,n.jsxs)("li",{className:"text-sm p-2 border rounded bg-muted/40",children:[(0,n.jsxs)("p",{children:[(0,n.jsx)("strong",{children:"ID:"})," ",t.id]}),t.name&&(0,n.jsxs)("p",{children:[(0,n.jsxs)("strong",{children:[e("name"),":"]})," ",t.name]}),t.email&&(0,n.jsxs)("p",{children:[(0,n.jsxs)("strong",{children:[e("email"),":"]})," ",t.email]})]},t.id))}),!s&&!r&&!(null==t?void 0:t.length)&&(0,n.jsx)("p",{className:"text-sm text-muted-foreground",children:e("empty")})]})]})}let eN=(0,f.A)("users-card");function eS(e){eN("Rendering UsersCard with tabs");let t=(0,v.c3)("usersList");return(0,n.jsxs)(a.Zp,{...e,children:[(0,n.jsxs)(a.aR,{children:[(0,n.jsx)(a.ZB,{children:t("title")}),(0,n.jsx)(a.BT,{children:t("description")})]}),(0,n.jsx)(a.Wu,{children:(0,n.jsxs)(l.tU,{defaultValue:"query",children:[" ",(0,n.jsxs)(l.j7,{className:"grid w-full grid-cols-2",children:[" ",(0,n.jsx)(l.Xi,{value:"query",children:t("tabs.query")}),(0,n.jsx)(l.Xi,{value:"subscription",children:t("tabs.subscription")})]}),(0,n.jsx)(l.av,{value:"query",className:"mt-4",children:(0,n.jsx)(ey,{})}),(0,n.jsx)(l.av,{value:"subscription",className:"mt-4",children:(0,n.jsx)(ew,{})})]})})]})}var ek=s(86612),eE=s(51362);let eC=e=>{let{...t}=e,{theme:s="system"}=(0,eE.D)();return(0,n.jsx)(es.l$,{theme:s,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...t})};function e_(e){let{serverSession:t,sidebarData:s}=e;return(0,n.jsxs)(r.SidebarLayout,{sidebarData:s,breadcrumb:[{title:"Hasyx",link:"/"},{title:"Diagnostics",link:"/hasyx/diagnostics"}],children:[(0,n.jsxs)("div",{className:"flex flex-1 flex-col gap-4 p-4",children:[(0,n.jsxs)("div",{className:"grid auto-rows-min gap-4 md:grid-cols-2",children:[(0,n.jsx)(ea,{}),(0,n.jsx)(ev,{}),(0,n.jsx)(q,{}),(0,n.jsx)(y,{}),(0,n.jsx)(et,{serverSession:t}),(0,n.jsx)(en,{}),(0,n.jsx)(ek.Ow,{}),(0,n.jsx)(eS,{})]}),(0,n.jsxs)("div",{className:"grid auto-rows-min gap-4 md:grid-cols-3",children:[(0,n.jsx)("div",{className:"aspect-video rounded-xl bg-muted/50"}),(0,n.jsx)("div",{className:"aspect-video rounded-xl bg-muted/50"}),(0,n.jsx)("div",{className:"aspect-video rounded-xl bg-muted/50"})]}),(0,n.jsx)("div",{className:"min-h-[100vh] flex-1 rounded-xl bg-muted/50 md:min-h-min"})]}),(0,n.jsx)(eC,{})]})}},64472:(e,t,s)=>{"use strict";s.d(t,{default:()=>u});var n=s(95155),r=s(12115),i=s(88893),a=s(97168),l=s(89852),c=s(88482),d=s(76037),o=s(56671);function u(){(0,i.c3)("diagnostics.invites");let e=(0,i.Dh)(),[t,s]=(0,r.useState)(!1),[u,h]=(0,r.useState)(""),[x,m]=(0,r.useState)(""),[p,v]=(0,r.useState)([]),[j,g]=(0,r.useState)([]),[f,y]=(0,r.useState)([]),[b,w]=(0,r.useState)([]),N=(0,r.useMemo)(()=>e.userId,[e.userId]);async function S(){if(N){s(!0);try{let t=await e.select({table:"invites",where:{user_id:{_eq:N}},returning:["id","code","created_at","updated_at","user_id"],role:"me"});v(Array.isArray(t)?t:t?[t]:[]);let s=await e.select({table:"invited",where:{_or:[{user_id:{_eq:N}},{invite:{user_id:{_eq:N}}}]},returning:["id","invite_id","user_id","created_at"],role:"me"});g(Array.isArray(s)?s:s?[s]:[]);try{let t=await e.select({table:"invites",where:{},returning:["id","code","created_at","updated_at","user_id"],role:e.apolloClient._options.secret?"admin":void 0});y(Array.isArray(t)?t:t?[t]:[])}catch(e){}try{let t=await e.select({table:"invited",where:{},returning:["id","invite_id","user_id","created_at"],role:e.apolloClient._options.secret?"admin":void 0});w(Array.isArray(t)?t:t?[t]:[])}catch(e){}}finally{s(!1)}}}async function k(){if(!N)return void o.oR.error("No user");s(!0);try{let t=await e.insert({table:"invites",object:{user_id:N,code:u||void 0},returning:["id","code","created_at","user_id"],role:"me"});o.oR.success("Invite created: ".concat((null==t?void 0:t.code)||"")),h(""),S()}catch(e){o.oR.error((null==e?void 0:e.message)||"Failed to create invite")}finally{s(!1)}}async function E(){s(!0);try{let t=await e.invite(x.trim());(null==t?void 0:t.success)?(o.oR.success("Invite redeemed"),m(""),S()):o.oR.error((null==t?void 0:t.message)||"Failed to redeem invite")}catch(e){o.oR.error((null==e?void 0:e.message)||"Failed to redeem invite")}finally{s(!1)}}async function C(t){s(!0);try{await e.delete({table:"invites",pk_columns:{id:t},returning:["id"],role:"me"}),o.oR.success("Invite deleted"),S()}catch(e){o.oR.error((null==e?void 0:e.message)||"Failed to delete invite")}finally{s(!1)}}return(0,r.useEffect)(()=>{S()},[N]),(0,n.jsx)("div",{className:"p-4",children:(0,n.jsxs)(c.Zp,{className:"mb-4",children:[(0,n.jsxs)(c.aR,{children:[(0,n.jsx)(c.ZB,{children:"Invites diagnostics"}),(0,n.jsx)(c.BT,{children:"Create, redeem, and inspect invites"})]}),(0,n.jsxs)(c.Wu,{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"flex flex-col md:flex-row gap-2",children:[(0,n.jsx)(l.p,{placeholder:"Custom code (optional)",value:u,onChange:e=>h(e.target.value)}),(0,n.jsx)(a.$,{disabled:t,onClick:k,children:"Create Invite"})]}),(0,n.jsxs)("div",{className:"flex flex-col md:flex-row gap-2",children:[(0,n.jsx)(l.p,{placeholder:"Invite code",value:x,onChange:e=>m(e.target.value)}),(0,n.jsx)(a.$,{disabled:t||!x.trim(),onClick:E,children:"Redeem Invite"})]}),(0,n.jsx)(d.w,{}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)(c.Zp,{children:[(0,n.jsxs)(c.aR,{children:[(0,n.jsx)(c.ZB,{children:"My invites"}),(0,n.jsxs)(c.BT,{children:["Total: ",p.length]})]}),(0,n.jsx)(c.Wu,{children:(0,n.jsxs)("div",{className:"space-y-2",children:[p.map(e=>(0,n.jsxs)("div",{className:"flex items-center justify-between border rounded-md p-2",children:[(0,n.jsxs)("div",{className:"text-sm",children:[(0,n.jsxs)("div",{children:["Code: ",(0,n.jsx)("b",{children:e.code})]}),(0,n.jsxs)("div",{className:"text-muted-foreground",children:["id: ",e.id]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(a.$,{size:"sm",variant:"outline",onClick:()=>navigator.clipboard.writeText(e.code),children:"Copy"}),(0,n.jsx)(a.$,{size:"sm",variant:"destructive",onClick:()=>C(e.id),children:"Delete"})]})]},e.id)),0===p.length&&(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:"No invites"})]})})]}),(0,n.jsxs)(c.Zp,{children:[(0,n.jsxs)(c.aR,{children:[(0,n.jsx)(c.ZB,{children:"My invited relations"}),(0,n.jsxs)(c.BT,{children:["Total: ",j.length]})]}),(0,n.jsx)(c.Wu,{children:(0,n.jsxs)("div",{className:"space-y-2",children:[j.map(e=>(0,n.jsxs)("div",{className:"border rounded-md p-2 text-sm",children:[(0,n.jsxs)("div",{children:["id: ",e.id]}),(0,n.jsxs)("div",{children:["invite_id: ",e.invite_id]}),(0,n.jsxs)("div",{children:["user_id: ",e.user_id]}),(0,n.jsxs)("div",{children:["created_at: ",e.created_at]})]},e.id)),0===j.length&&(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:"No invited records"})]})})]})]}),(0,n.jsx)(d.w,{}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)(c.Zp,{children:[(0,n.jsxs)(c.aR,{children:[(0,n.jsx)(c.ZB,{children:"All invites (admin)"}),(0,n.jsxs)(c.BT,{children:["Total: ",f.length]})]}),(0,n.jsx)(c.Wu,{children:(0,n.jsxs)("div",{className:"space-y-2",children:[f.map(e=>(0,n.jsxs)("div",{className:"border rounded-md p-2 text-sm",children:[(0,n.jsxs)("div",{children:["code: ",(0,n.jsx)("b",{children:e.code})]}),(0,n.jsxs)("div",{children:["id: ",e.id]}),(0,n.jsxs)("div",{children:["user_id: ",e.user_id]})]},e.id)),0===f.length&&(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:"—"})]})})]}),(0,n.jsxs)(c.Zp,{children:[(0,n.jsxs)(c.aR,{children:[(0,n.jsx)(c.ZB,{children:"All invited (admin)"}),(0,n.jsxs)(c.BT,{children:["Total: ",b.length]})]}),(0,n.jsx)(c.Wu,{children:(0,n.jsxs)("div",{className:"space-y-2",children:[b.map(e=>(0,n.jsxs)("div",{className:"border rounded-md p-2 text-sm",children:[(0,n.jsxs)("div",{children:["id: ",e.id]}),(0,n.jsxs)("div",{children:["invite_id: ",e.invite_id]}),(0,n.jsxs)("div",{children:["user_id: ",e.user_id]}),(0,n.jsxs)("div",{children:["created_at: ",e.created_at]})]},e.id)),0===b.length&&(0,n.jsx)("div",{className:"text-sm text-muted-foreground",children:"—"})]})})]})]})]})]})})}},87251:(e,t,s)=>{"use strict";s.d(t,{n:()=>d});var n=s(95155),r=s(97168),i=s(88893),a=s(51154),l=s(5196),c=s(54416);function d(e){let{status:t="connecting",label:s,error:d}=e,o=(0,i.c3)("common"),u=s||o("loading"),h=s||o("yes"),x=s||o("error"),m=s||"Idle";return(0,n.jsxs)(n.Fragment,{children:["connecting"===t&&(0,n.jsxs)(r.$,{variant:"ghost",className:"p-0",children:[(0,n.jsx)(a.A,{className:"animate-spin mr-1"})," ",u]}),"connected"===t&&(0,n.jsxs)(r.$,{variant:"ghost",className:"p-0",children:[(0,n.jsx)(l.A,{className:"mr-1"})," ",h]}),"error"===t&&(0,n.jsxs)(r.$,{variant:"ghost",className:"p-0",children:[(0,n.jsx)(c.A,{className:"mr-1"})," ",x]}),"idle"===t&&(0,n.jsxs)(r.$,{variant:"ghost",className:"p-0",children:[(0,n.jsx)(c.A,{className:"mr-1"})," ",m]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[2115,5741,8893,5366,8441,1684,7358],()=>t(49853)),_N_E=e.O()}]);