(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9763],{9712:(e,s,a)=>{Promise.resolve().then(a.bind(a,85406))},23439:(e,s,a)=>{"use strict";a.d(s,{u:()=>l});var t=a(12115),i=a(40246);function l(){let[e,s]=(0,t.useState)({isSupported:!1,isInstalled:!1,installPromptAvailable:!1,updateAvailable:!1,displayMode:"browser",isInitialized:!1}),[a,l]=(0,t.useState)(null);(0,t.useEffect)(()=>{(async()=>{let e=await (0,i.initializePWA)();e?(s(s=>({...s,isSupported:!0,isInstalled:e.isPWA,installPromptAvailable:e.installPrompt.isAvailable,displayMode:e.displayMode,isInitialized:!0})),l(()=>e.installPrompt.prompt)):s(e=>({...e,isInitialized:!0}))})()},[]),(0,t.useEffect)(()=>{let e=()=>{s(e=>({...e,installPromptAvailable:!0}))},a=()=>{s(e=>({...e,isInstalled:!0,installPromptAvailable:!1}))},t=()=>{s(e=>({...e,updateAvailable:!0}))},i=e=>{console.log("iOS installation instructions:",e.detail.message)};return window.addEventListener("pwa-install-available",e),window.addEventListener("pwa-installed",a),window.addEventListener("sw-update-available",t),window.addEventListener("pwa-ios-instructions",i),()=>{window.removeEventListener("pwa-install-available",e),window.removeEventListener("pwa-installed",a),window.removeEventListener("sw-update-available",t),window.removeEventListener("pwa-ios-instructions",i)}},[]);let n=(0,t.useCallback)(async()=>{if(a)try{await a()}catch(e){console.error("Failed to show install prompt:",e)}},[a]),r=(0,t.useCallback)(async()=>{try{await (0,i.updateServiceWorker)()}catch(e){console.error("Failed to update service worker:",e)}},[]),d=(0,t.useCallback)(()=>{s(e=>({...e,updateAvailable:!1}))},[]);return{...e,install:n,update:r,showNotification:i.showNotification,dismissUpdate:d}}},54213:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]])},54861:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]])},85406:(e,s,a)=>{"use strict";a.d(s,{default:()=>P});var t=a(95155),i=a(12115),l=a(55366),n=a(88482),r=a(97168),d=a(88145),c=a(34964),o=a(40646),m=a(85339),h=a(54861),u=a(19946);let x=(0,u.A)("wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),p=(0,u.A)("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);var f=a(53904),w=a(91788),j=a(46767);let v=(0,u.A)("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);var y=a(54213);let g=(0,u.A)("code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);var N=a(62525),b=a(23439),A=a(40246);function k(e){let{serverSession:s,sidebarData:u}=e,[k,P]=(0,i.useState)("undefined"==typeof navigator||navigator.onLine),[W,S]=(0,i.useState)([]),[C,I]=(0,i.useState)({canInstall:!1,isInstalled:!1,platform:"unknown"}),[E,M]=(0,i.useState)([]),[R,z]=(0,i.useState)(!1),[L,Z]=(0,i.useState)(!1),{isSupported:B,isInstalled:T,installPromptAvailable:O,updateAvailable:F,displayMode:D,isInitialized:$,install:U,update:_}=(0,b.u)();(0,i.useEffect)(()=>{let e=()=>P(!0),s=()=>P(!1);return window.addEventListener("online",e),window.addEventListener("offline",s),P(navigator.onLine),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}},[]),(0,i.useEffect)(()=>{q()},[]),(0,i.useEffect)(()=>{X()},[T,O]);let q=async()=>{try{if("caches"in window){let e=await caches.keys(),s=[];for(let a of e){let e=await caches.open(a),t=await e.keys();s.push({name:a,size:0,lastModified:new Date,entries:t.length})}S(s)}}catch(e){console.error("Failed to load cache info:",e)}},X=()=>{if("undefined"==typeof navigator)return;let e=navigator.userAgent,s=/iPad|iPhone|iPod/.test(e),a=/Android/.test(e),t=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone,i="desktop";s?i="ios":a&&(i="android");let l="";t?l="Already installed and running in standalone mode":B?s&&!/Safari/.test(e)?l="iOS requires Safari browser for PWA installation":O||(l="Browser install prompt not available (may need user engagement)"):l="PWA not supported on this browser/device",I({canInstall:O&&!T,isInstalled:t||T,platform:i,reason:l})},H=async e=>{try{if(e){let{clearCache:s}=await Promise.resolve().then(a.bind(a,60817));await s(e)}else{let{clearAllCaches:e}=await Promise.resolve().then(a.bind(a,60817)),s=await e();s.success&&"Notification"in window&&"granted"===Notification.permission&&(0,A.showNotification)("Cache Cleared",{body:"Cleared ".concat(s.clearedCaches.length," caches, freed ~").concat(Math.round(s.totalBytesFreed/1024),"KB"),tag:"cache-clear"})}await q()}catch(e){console.error("Failed to clear cache:",e)}},V=async()=>{try{let{forceReloadFromServer:e}=await Promise.resolve().then(a.bind(a,60817));await e()}catch(e){console.error("Failed to force update:",e),await (0,A.updateServiceWorker)()}},J=async()=>{Z(!0);try{let{completePWAReset:e}=await Promise.resolve().then(a.bind(a,60817)),s=await e();s.success?("Notification"in window&&"granted"===Notification.permission&&(0,A.showNotification)("PWA Reset Complete",{body:"".concat(s.actions.length," actions completed. Page will reload shortly."),tag:"pwa-uninstall"}),setTimeout(()=>{window.location.reload()},2e3)):console.error("PWA reset failed:",s.errors)}catch(e){console.error("Failed to uninstall PWA:",e)}finally{Z(!1)}},K=async()=>{z(!0);let e=[],s=(0,A.checkPWASupport)();e.push({name:"PWA Support",status:s&&s.serviceWorker?"passed":"failed",message:s&&s.serviceWorker?"Browser supports PWA features":"Browser lacks PWA support",details:s});try{let s=await fetch("/manifest.webmanifest"),a=await s.json();e.push({name:"Web App Manifest",status:s.ok?"passed":"failed",message:s.ok?"Manifest loaded: ".concat(a.name):"Manifest not found",details:a})}catch(s){e.push({name:"Web App Manifest",status:"failed",message:"Failed to load manifest",details:s})}try{let s=await fetch("/sw.js");e.push({name:"Service Worker",status:s.ok?"passed":"failed",message:s.ok?"Service worker file accessible":"Service worker not found",details:{status:s.status}})}catch(s){e.push({name:"Service Worker",status:"failed",message:"Service worker not accessible",details:s})}let a=window.isSecureContext,t=window.location.protocol;e.push({name:"Secure Context",status:a?"passed":"failed",message:a?"Running on HTTPS":"HTTPS required for PWA",details:{protocol:t}});let i="Notification"in window?Notification.permission:"not-supported";e.push({name:"Notifications",status:"granted"===i?"passed":"default"===i?"warning":"failed",message:"Notification permission: ".concat(i),details:{permission:i}});let l="caches"in window;e.push({name:"Cache API",status:l?"passed":"failed",message:l?"Cache API available":"Cache API not supported",details:{supported:l}}),e.push({name:"Network Status",status:k?"passed":"warning",message:k?"Online":"Offline (testing offline capability)",details:{online:k}}),e.push({name:"Installation",status:C.isInstalled?"passed":C.canInstall?"warning":"failed",message:C.isInstalled?"PWA is installed":C.canInstall?"Can be installed":"Cannot be installed",details:C}),M(e),z(!1)},Y=e=>{switch(e){case"passed":return(0,t.jsx)(o.A,{className:"h-4 w-4 text-green-600"});case"warning":return(0,t.jsx)(m.A,{className:"h-4 w-4 text-yellow-600"});case"failed":return(0,t.jsx)(h.A,{className:"h-4 w-4 text-red-600"});default:return(0,t.jsx)(m.A,{className:"h-4 w-4 text-gray-400"})}};return(0,t.jsx)(l.SidebarLayout,{sidebarData:u,breadcrumb:[{title:"Hasyx",link:"/"},{title:"PWA Diagnostics",link:"/hasyx/pwa"}],children:(0,t.jsxs)("div",{className:"flex flex-1 flex-col gap-4 p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"PWA Diagnostics"}),k?(0,t.jsxs)(d.E,{variant:"default",className:"flex items-center gap-1",children:[(0,t.jsx)(x,{className:"h-3 w-3"}),"Online"]}):(0,t.jsxs)(d.E,{variant:"destructive",className:"flex items-center gap-1",children:[(0,t.jsx)(p,{className:"h-3 w-3"}),"Offline"]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(r.$,{onClick:V,variant:"outline",size:"sm",children:[(0,t.jsx)(f.A,{className:"h-4 w-4 mr-2"}),"Force Update"]}),C.canInstall&&(0,t.jsxs)(r.$,{onClick:U,size:"sm",children:[(0,t.jsx)(w.A,{className:"h-4 w-4 mr-2"}),"Install PWA"]})]})]}),(0,t.jsxs)(c.tU,{defaultValue:"overview",className:"flex-1",children:[(0,t.jsxs)(c.j7,{className:"grid w-full grid-cols-5",children:[(0,t.jsx)(c.Xi,{value:"overview",children:"Overview"}),(0,t.jsx)(c.Xi,{value:"tests",children:"Tests"}),(0,t.jsx)(c.Xi,{value:"cache",children:"Cache"}),(0,t.jsx)(c.Xi,{value:"install",children:"Install"}),(0,t.jsx)(c.Xi,{value:"uninstall",children:"Uninstall"})]}),(0,t.jsxs)(c.av,{value:"overview",className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:[(0,t.jsxs)(n.Zp,{children:[(0,t.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(n.ZB,{className:"text-sm font-medium",children:"PWA Status"}),(0,t.jsx)(j.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(n.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:C.isInstalled?"Installed":"Web App"}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Platform: ",C.platform]}),(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(d.E,{variant:B?"default":"destructive",children:B?"Supported":"Not Supported"})})]})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(n.ZB,{className:"text-sm font-medium",children:"Display Mode"}),(0,t.jsx)(v,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(n.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold capitalize",children:D||(0,A.getPWADisplayMode)()}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:(0,A.isPWA)()?"Running as PWA":"Running in browser"})]})]}),(0,t.jsxs)(n.Zp,{children:[(0,t.jsxs)(n.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(n.ZB,{className:"text-sm font-medium",children:"Cache Status"}),(0,t.jsx)(y.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(n.Wu,{children:[(0,t.jsx)("div",{className:"text-2xl font-bold",children:W.length}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Active caches"}),(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsxs)(d.E,{variant:"outline",children:[W.reduce((e,s)=>e+s.entries,0)," entries"]})})]})]})]}),E.length>0&&(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsx)(n.ZB,{children:"Recent Test Results"})}),(0,t.jsx)(n.Wu,{children:(0,t.jsx)("div",{className:"space-y-2",children:E.slice(0,5).map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-2 border rounded",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[Y(e.status),(0,t.jsx)("span",{className:"text-sm font-medium",children:e.name})]}),(0,t.jsx)(d.E,{variant:"passed"===e.status?"default":"warning"===e.status?"secondary":"destructive",children:e.status})]},s))})})]})]}),(0,t.jsx)(c.av,{value:"tests",className:"space-y-4",children:(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(n.ZB,{children:"PWA Stability Tests"}),(0,t.jsxs)(r.$,{onClick:K,disabled:R,className:"flex items-center gap-2",children:[(0,t.jsx)(g,{className:"h-4 w-4"}),R?"Running Tests...":"Run Tests"]})]})}),(0,t.jsx)(n.Wu,{children:0===E.length?(0,t.jsx)("p",{className:"text-muted-foreground text-center py-8",children:'Click "Run Tests" to start PWA stability testing'}):(0,t.jsx)("div",{className:"space-y-3",children:E.map((e,s)=>(0,t.jsxs)("div",{className:"border rounded p-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[Y(e.status),(0,t.jsx)("span",{className:"font-medium",children:e.name})]}),(0,t.jsx)(d.E,{variant:"passed"===e.status?"default":"warning"===e.status?"secondary":"destructive",children:e.status})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.message}),e.details&&(0,t.jsxs)("details",{className:"mt-2",children:[(0,t.jsx)("summary",{className:"cursor-pointer text-xs text-blue-600",children:"Show details"}),(0,t.jsx)("pre",{className:"mt-1 p-2 bg-gray-100 rounded text-xs overflow-x-auto",children:JSON.stringify(e.details,null,2)})]})]},s))})})]})}),(0,t.jsx)(c.av,{value:"cache",className:"space-y-4",children:(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(n.ZB,{children:"Cache Management"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(r.$,{onClick:q,variant:"outline",size:"sm",children:[(0,t.jsx)(f.A,{className:"h-4 w-4 mr-2"}),"Refresh"]}),(0,t.jsxs)(r.$,{onClick:()=>H(),variant:"destructive",size:"sm",children:[(0,t.jsx)(N.A,{className:"h-4 w-4 mr-2"}),"Clear All"]})]})]})}),(0,t.jsx)(n.Wu,{children:0===W.length?(0,t.jsx)("p",{className:"text-muted-foreground text-center py-8",children:"No caches found"}):(0,t.jsx)("div",{className:"space-y-3",children:W.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium",children:e.name}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.entries," entries"]})]}),(0,t.jsxs)(r.$,{onClick:()=>H(e.name),variant:"outline",size:"sm",children:[(0,t.jsx)(N.A,{className:"h-4 w-4 mr-1"}),"Clear"]})]},s))})})]})}),(0,t.jsx)(c.av,{value:"install",className:"space-y-4",children:(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsx)(n.ZB,{children:"Installation Status"})}),(0,t.jsx)(n.Wu,{className:"space-y-4",children:(0,t.jsxs)("div",{className:"grid gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium",children:"Current Status"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:C.isInstalled?"PWA is installed":"Running as web app"})]}),(0,t.jsx)(d.E,{variant:C.isInstalled?"default":"secondary",children:C.isInstalled?"Installed":"Not Installed"})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium",children:"Platform"}),(0,t.jsxs)("p",{className:"text-sm text-muted-foreground",children:[C.platform," - ","undefined"!=typeof navigator?navigator.userAgent.substring(0,50)+"...":"User agent not available"]})]}),(0,t.jsx)(d.E,{variant:"outline",children:C.platform})]}),C.reason&&(0,t.jsxs)("div",{className:"p-4 border rounded bg-muted/50",children:[(0,t.jsx)("h4",{className:"font-medium mb-2",children:"Installation Info"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:C.reason})]}),C.canInstall&&(0,t.jsxs)(r.$,{onClick:U,className:"w-full",children:[(0,t.jsx)(w.A,{className:"h-4 w-4 mr-2"}),"Install PWA"]})]})})]})}),(0,t.jsx)(c.av,{value:"uninstall",className:"space-y-4",children:(0,t.jsxs)(n.Zp,{children:[(0,t.jsx)(n.aR,{children:(0,t.jsx)(n.ZB,{className:"text-red-600",children:"PWA Uninstall & Reset"})}),(0,t.jsxs)(n.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded p-4",children:[(0,t.jsx)("h4",{className:"font-medium text-red-800 mb-2",children:"⚠️ Warning"}),(0,t.jsx)("p",{className:"text-sm text-red-700",children:"This will completely reset the PWA by clearing all cached data, unregistering service workers, and removing all local storage. The page will reload automatically."})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("h4",{className:"font-medium",children:"What will be cleared:"}),(0,t.jsxs)("ul",{className:"text-sm text-muted-foreground space-y-1 ml-4",children:[(0,t.jsx)("li",{children:"• All cache storage"}),(0,t.jsx)("li",{children:"• Service worker registrations"}),(0,t.jsx)("li",{children:"• Local storage data"}),(0,t.jsx)("li",{children:"• Session storage data"}),(0,t.jsx)("li",{children:"• IndexedDB databases"})]})]}),(0,t.jsxs)(r.$,{onClick:J,variant:"destructive",disabled:L,className:"w-full",children:[(0,t.jsx)(N.A,{className:"h-4 w-4 mr-2"}),L?"Uninstalling...":"Complete PWA Reset"]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground text-center",children:"Note: This doesn't remove the PWA from your home screen. You'll need to manually remove it from your device."})]})]})})]})]})})}function P(e){let{serverSession:s,sidebarData:a}=e;return(0,t.jsx)(k,{serverSession:s,sidebarData:a})}},91788:(e,s,a)=>{"use strict";a.d(s,{A:()=>t});let t=(0,a(19946).A)("download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[2115,5741,8893,5366,8441,1684,7358],()=>s(9712)),_N_E=e.O()}]);