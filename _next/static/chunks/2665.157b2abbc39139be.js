"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2665],{4005:(e,t,n)=>{n.d(t,{$n:()=>W,Zp:()=>q,EP:()=>Z});var a={};n.r(a),n.d(a,{Button:()=>x,Card:()=>v,CytoNode:()=>y});var s={};n.r(s),n.d(s,{Button:()=>b,Card:()=>j,CytoNode:()=>N});var l={};n.r(l),n.d(l,{Card:()=>z,CytoNode:()=>I});var o={};n.r(o),n.d(o,{Button:()=>P,Card:()=>L,CytoNode:()=>B});var r=n(95155),i=n(12115),c=n(88893),d=n(97168),u=n(88482),h=n(69663),m=n(88145),p=n(54416),g=n(49514),f=n(53999);function x(e){let{data:t,...n}=e,a="string"==typeof t?t:null==t?void 0:t.id,s="object"==typeof t?t:null,l=(null==s?void 0:s.name)||(null==s?void 0:s.email)||"User ".concat(a),o=(null==s?void 0:s.name)?s.name.split(" ").map(e=>e[0]).join("").toUpperCase():(null==s?void 0:s.email)?s.email.substring(0,2).toUpperCase():"U";return(0,r.jsxs)(d.$,{variant:"outline",className:"h-auto p-2 justify-start gap-2 min-w-0",...n,children:[(0,r.jsxs)(h.eu,{className:"w-6 h-6 flex-shrink-0",children:[(0,r.jsx)(h.BK,{src:null==s?void 0:s.image}),(0,r.jsx)(h.q5,{className:"text-xs",children:o})]}),(0,r.jsx)("span",{className:"truncate text-xs",children:l})]})}function v(e){let{data:t,onClose:n,...a}=e,s="string"==typeof t?t:null==t?void 0:t.id,l="object"==typeof t?t:null,{data:o,loading:i,error:g}=(0,c.IT)({table:"users",pk_columns:{id:s},returning:["id","name","email","image","created_at","updated_at"]},{skip:!s,role:"user"}),f=l||o,x=(0,c.c3)("entities.users");return i?(0,r.jsx)(u.Zp,{className:"w-80",...a,children:(0,r.jsx)(u.Wu,{className:"p-4",children:(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:x("loading")})})}):g||!f?(0,r.jsx)(u.Zp,{className:"w-80",...a,children:(0,r.jsx)(u.Wu,{className:"p-4",children:(0,r.jsx)("div",{className:"text-sm text-destructive",children:x("failed")})})}):(0,r.jsxs)(u.Zp,{className:"w-80",...a,children:[(0,r.jsx)(u.aR,{className:"pb-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsxs)(h.eu,{className:"w-10 h-10",children:[(0,r.jsx)(h.BK,{src:f.image}),(0,r.jsx)(h.q5,{children:f.name?f.name.split(" ").map(e=>e[0]).join(""):f.email?f.email.substring(0,2).toUpperCase():"U"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)(u.ZB,{className:"text-base",children:f.name||x("unknownUser")}),f.email&&(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:f.email})]})]}),n&&(0,r.jsx)(d.$,{variant:"ghost",size:"sm",onClick:n,className:"h-6 w-6 p-0",children:(0,r.jsx)(p.A,{className:"h-4 w-4"})})]})}),(0,r.jsx)(u.Wu,{className:"pt-0",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("div",{className:"flex items-center gap-2",children:(0,r.jsxs)(m.E,{variant:"outline",className:"text-xs",children:[x("id"),": ",f.id]})}),f.created_at&&(0,r.jsxs)("div",{className:"text-xs text-muted-foreground",children:[x("created"),": ",new Date(f.created_at).toLocaleDateString()]}),f.updated_at&&(0,r.jsxs)("div",{className:"text-xs text-muted-foreground",children:[x("updated"),": ",new Date(f.updated_at).toLocaleDateString()]})]})})]})}function y(e){var t;let{data:n,...a}=e,s=(null==n?void 0:n.name)||(null==n||null==(t=n.id)?void 0:t.slice(0,4)),l=null==n?void 0:n.image,[o,c]=(0,i.useState)(!1);return(0,r.jsx)(g.EP,{...a,onClick:()=>c(!0),element:{id:n.id,data:{id:n.id,label:s,image:l},...null==a?void 0:a.element,classes:(0,f.cn)("entity",{avatar:!!l,opened:o},a.classes)},children:o?(0,r.jsx)(v,{data:n,onClose:()=>c(!1)}):null})}function b(e){let{data:t,...n}=e,a="string"==typeof t?t:null==t?void 0:t.id,s="object"==typeof t?t:null,l=(null==s?void 0:s.provider)?"".concat(s.provider):"Account ".concat(a);return(0,r.jsxs)(d.$,{variant:"outline",className:"h-auto p-2 justify-start gap-2 min-w-0",...n,children:[(0,r.jsx)("span",{className:"text-sm",children:(e=>{switch(null==e?void 0:e.toLowerCase()){case"google":return"\uD83D\uDD0D";case"github":return"\uD83D\uDC19";case"discord":return"\uD83D\uDCAC";case"twitter":return"\uD83D\uDC26";default:return"\uD83D\uDD11"}})(null==s?void 0:s.provider)}),(0,r.jsx)("span",{className:"truncate text-xs",children:l})]})}function j(e){let{data:t,onClose:n,...a}=e,s="string"==typeof t?t:null==t?void 0:t.id,l="object"==typeof t?t:null,{data:o,loading:i,error:h}=(0,c.IT)({table:"accounts",pk_columns:{id:s},returning:["id","provider","user_id"]},{skip:!s,role:"user"}),g=l||o,f=(0,c.c3)("entities.accounts");return i?(0,r.jsx)(u.Zp,{className:"w-80",...a,children:(0,r.jsx)(u.Wu,{className:"p-4",children:(0,r.jsx)("div",{className:"text-sm text-muted-foreground",children:f("loading")})})}):h||!g?(0,r.jsx)(u.Zp,{className:"w-80",...a,children:(0,r.jsx)(u.Wu,{className:"p-4",children:(0,r.jsx)("div",{className:"text-sm text-destructive",children:f("failed")})})}):(0,r.jsxs)(u.Zp,{className:"w-80",...a,children:[(0,r.jsx)(u.aR,{className:"pb-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 flex items-center justify-center bg-muted rounded-full text-lg",children:(e=>{switch(null==e?void 0:e.toLowerCase()){case"google":return"\uD83D\uDD0D";case"github":return"\uD83D\uDC19";case"discord":return"\uD83D\uDCAC";case"twitter":return"\uD83D\uDC26";default:return"\uD83D\uDD11"}})(g.provider)}),(0,r.jsxs)("div",{children:[(0,r.jsx)(u.ZB,{className:"text-base capitalize",children:g.provider||f("unknownProvider")}),g.provider_id&&(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[f("id"),": ",g.provider_id]})]})]}),n&&(0,r.jsx)(d.$,{variant:"ghost",size:"sm",onClick:n,className:"h-6 w-6 p-0",children:(0,r.jsx)(p.A,{className:"h-4 w-4"})})]})}),(0,r.jsx)(u.Wu,{className:"pt-0",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(m.E,{variant:"outline",className:"text-xs",children:[f("id"),": ",g.id]}),g.user_id&&(0,r.jsxs)(m.E,{variant:"secondary",className:"text-xs",children:[f("user"),": ",g.user_id]})]}),g.created_at&&(0,r.jsxs)("div",{className:"text-xs text-muted-foreground",children:[f("created"),": ",new Date(g.created_at).toLocaleDateString()]}),g.updated_at&&(0,r.jsxs)("div",{className:"text-xs text-muted-foreground",children:[f("updated"),": ",new Date(g.updated_at).toLocaleDateString()]})]})})]})}function N(e){let{data:t,...n}=e;return(0,r.jsx)(g.EP,{...n,element:{id:t.id,data:{id:t.id,label:null==t?void 0:t.provider},...null==n?void 0:n.element,classes:(0,f.cn)("entity",n.classes)}})}var C=n(37777),w=n(38164),E=n(92138),_=n(2775),k=n(89917),G=n(71366);function S(e){let t;if(!e)return{content:"",relations:{}};let n=/<details>\s*<summary>Relations<\/summary>\s*```json\s*(\{[\s\S]*?\})\s*```\s*<\/details>\s*$/,a=e.match(n),s={};if(a)try{let l=a[1];s=JSON.parse(l),t=e.replace(n,"").trim()}catch(n){console.error("Failed to parse relations JSON:",n),t=e.trim()}else t=e.trim();let{issues:l,commits:o}=function(e){let t,n=[],a=[],s=/#(\d+)/g;for(;null!==(t=s.exec(e));)n.push("issue:".concat(t[1]));let l=/commit:([a-f0-9]+)/gi;for(;null!==(t=l.exec(e));)a.push("commit:".concat(t[1]));return{issues:[...new Set(n)],commits:[...new Set(a)]}}(t);return l.length>0&&(s.issues=l),o.length>0&&(s.commits=o),{content:t,relations:s}}var M=n(35929);async function R(e,t,n,a){console.log("updateIssueRelations called with:",{sourceIssueData:e,targetIssueData:t,relationType:n});let{data:s}=await a.query({table:"github_issues",where:{github_id:{_eq:t.github_id}},returning:["id","github_id","number","title"]});if(!s||0===s.length)return void console.error("Target issue not found:",t.github_id);let l=s[0],{content:o,relations:r}=S(e.body||"");r[n]||(r[n]=[]);let i="issue:".concat(l.number);r[n].includes(i)||r[n].push(i);let c=function(e,t){if(!e&&0===Object.keys(t).length)return"";let n=e.trim(),a={...t};if(delete a.issues,delete a.commits,Object.keys(a).length>0){let e=JSON.stringify(a,null,2);n+="\n\n<details>\n<summary>Relations</summary>\n```json\n".concat(e,"\n```\n</details>")}return n}(o,r);await a.update({table:"github_issues",where:{id:{_eq:e.id}},_set:{body:c}})}var D=n(99840),T=n(96426),A=n(89852),O=n(56671);function z(e){let{data:t,onClose:n,...a}=e,s=(0,c.c3)("actions"),l=(0,c.c3)("success"),o=(0,c.c3)("errors"),x=(0,c.c3)("common"),{startDrawing:v,onDrawingComplete:y,currentRelationType:b}=(0,M.U)(),j=(0,g.uU)(),N=null==j?void 0:j.toggleDrawMode,z=(0,c.Dh)(),[I,$]=(0,i.useState)(!1),[U,P]=(0,i.useState)(t.title||""),[L,B]=(0,i.useState)(t.body||""),[F,H]=(0,i.useState)(!1);(0,i.useEffect)(()=>{I&&(P(t.title||""),B(t.body||""))},[I,t.title,t.body]),t.pull_request_data;let W=(0,i.useCallback)(e=>{null==N||N(),v(e,z,async(e,t,n,a)=>{await R(e,t,n,a)})},[v,N,z]);return(0,r.jsxs)("div",{className:"relative group pointer-events-none",children:[(0,r.jsxs)("div",{className:"min-h-[2em] p-3 relative",children:[(0,r.jsx)("div",{className:"absolute inset-0 opacity-20 pointer-events-none rounded-xl",style:{backgroundImage:"\n              radial-gradient(circle at 1px 1px, currentColor 1px, transparent 1px),\n              radial-gradient(circle at 5px 5px, currentColor 1px, transparent 1px)\n            ",backgroundSize:"6px 6px",backgroundPosition:"0 0, 2px 2px",height:"150%"}}),t.labels_data&&t.labels_data.length>0&&(0,r.jsx)("div",{className:"flex items-center gap-1 flex-wrap relative z-10",children:t.labels_data.map(e=>(0,r.jsx)(m.E,{variant:"outline",className:"text-xs pointer-events-auto",style:{backgroundColor:"#".concat(e.color,"20"),borderColor:"#".concat(e.color),color:"#".concat(e.color)},children:e.name},e.id))})]}),(0,r.jsxs)(u.Zp,{className:"w-80 relative gap-1 z-1 pointer-events-auto",...a,children:[(0,r.jsx)(u.aR,{className:"pb-0",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-start gap-2 min-w-0",children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full flex-shrink-0 mt-2 ".concat("open"===t.state?"bg-green-500":"bg-red-500"),children:t.assignees_data&&t.assignees_data.length>0&&(0,r.jsx)("div",{className:"absolute left-0 top-5 flex flex-col gap-1 z-10 -ml-4",children:t.assignees_data.map((e,n)=>(0,r.jsxs)(C.m_,{children:[(0,r.jsx)(C.k$,{asChild:!0,children:(0,r.jsxs)(h.eu,{className:"w-8 h-8 border-2 border-white shadow-sm cursor-pointer",children:[(0,r.jsx)(h.BK,{src:e.avatar_url}),(0,r.jsx)(h.q5,{className:"text-xs",children:e.login.substring(0,2).toUpperCase()})]})}),(0,r.jsxs)(C.ZI,{side:"right",className:"text-xs",children:[(0,r.jsx)("p",{children:e.login}),t.author_association&&(0,r.jsx)("p",{className:"text-muted-foreground",children:t.author_association})]})]},e.id))})}),t.html_url?(0,r.jsx)("a",{href:t.html_url,target:"_blank",rel:"noopener noreferrer",className:"text-sm font-medium hover:underline hover:text-white transition-colors",children:t.title}):(0,r.jsx)(u.ZB,{className:"text-sm",children:t.title})]}),n&&(0,r.jsx)(d.$,{variant:"ghost",size:"sm",onClick:n,className:"flex-shrink-0",children:(0,r.jsx)(p.A,{className:"w-4 h-4"})})]})}),(0,r.jsx)(u.Wu,{className:"pt-0",children:t.body&&(0,r.jsx)("div",{className:"text-xs text-muted-foreground line-clamp-3 leading-relaxed",children:S(t.body).content})})]}),(0,r.jsxs)("div",{className:"absolute group-hover:top-[100%] top-[50%] z-0 transition-all delay-500 left-0 w-full px-2 pt-1 flex justify-between",children:[(0,r.jsxs)("div",{className:"flex gap-1 pointer-events-auto",children:[(0,r.jsx)(d.$,{variant:"ghost",size:"sm",onClick:()=>W("contains"),className:(0,f.cn)(y&&"bg-blue-500 text-white"),children:(0,r.jsx)(w.A,{className:"w-3 h-3"})}),(0,r.jsx)(d.$,{variant:"ghost",size:"sm",onClick:()=>W("requires"),className:(0,f.cn)(y&&"bg-orange-500 text-white"),children:(0,r.jsx)(E.A,{className:"w-3 h-3"})}),(0,r.jsx)(d.$,{variant:"ghost",size:"sm",onClick:()=>W("related"),className:(0,f.cn)(y&&"bg-green-500 text-white"),children:(0,r.jsx)(_.A,{className:"w-3 h-3"})})]}),(0,r.jsxs)("div",{className:"flex gap-1 pointer-events-auto",children:[(0,r.jsxs)(d.$,{variant:"ghost",size:"sm",onClick:()=>$(!0),className:"text-xs",children:[(0,r.jsx)(k.A,{className:"w-3 h-3 mr-1"}),s("edit")]}),void 0!==t.comments_count&&(0,r.jsxs)(d.$,{variant:"ghost",size:"sm",className:"text-xs",children:[(0,r.jsx)(G.A,{className:"w-3 h-3 mr-1"}),t.comments_count]})]})]}),(0,r.jsx)(D.lG,{open:I,onOpenChange:$,children:(0,r.jsxs)(D.Cf,{className:"sm:max-w-[600px]",children:[(0,r.jsx)(D.c7,{children:(0,r.jsxs)(D.L3,{children:[s("edit")," Issue"]})}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:"Title"}),(0,r.jsx)(A.p,{value:U,onChange:e=>P(e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:"Description"}),(0,r.jsx)(T.n,{value:L,onChange:B,minHeight:220})]})]}),(0,r.jsxs)(D.Es,{children:[(0,r.jsx)(d.$,{variant:"outline",onClick:()=>$(!1),disabled:F,children:s("cancel")}),(0,r.jsx)(d.$,{onClick:async()=>{if(t.id){H(!0);try{await z.update({table:"github_issues",where:{id:{_eq:t.id}},_set:{title:U,body:L,updated_at:Date.now()},returning:["id"]}),O.oR.success(l("issueUpdated")),$(!1)}catch(e){O.oR.error((null==e?void 0:e.message)||o("updateFailed"))}finally{H(!1)}}},disabled:F||!(null==U?void 0:U.trim()),children:F?x("saving"):s("save")})]})]})})]})}function I(e){let{data:t,availableIssues:n,...a}=e,s=(null==t?void 0:t.title)||"Issue #".concat(null==t?void 0:t.number);null==t||t.state;let l=!!(null==t?void 0:t.pull_request_data),{content:o,relations:c}=(0,i.useMemo)(()=>S((null==t?void 0:t.body)||""),[null==t?void 0:t.body]),{issueNumbers:d,relationTypes:u}=(0,i.useMemo)(()=>(function(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=[],s={};if(!e)return{issueNumbers:a,relationTypes:s};let l=/#(\d+)/g;for(;null!==(t=l.exec(e));){let e=parseInt(t[1],10);a.push(e),s[e]||(s[e]=[]),s[e].push("mentioned")}return Object.entries(n).forEach(e=>{let[t,n]=e;Array.isArray(n)&&n.forEach(e=>{if("string"==typeof e&&e.startsWith("issue:")){let n=parseInt(e.split(":")[1],10);isNaN(n)||(a.includes(n)||a.push(n),s[n]||(s[n]=[]),s[n].push(t))}})}),{issueNumbers:[...new Set(a)],relationTypes:s}})(o,c),[o,c]),h=(0,i.useMemo)(()=>{if(!d.length||!n)return[];let e=new Map;return n.forEach(t=>{t.number&&t.github_id&&e.set(t.number,t.github_id)}),d.filter(t=>e.has(t)).map(n=>{let a=e.get(n),s=u[n]||[],l="edge-github_issue".concat(t.github_id,"-github_issue").concat(a),o=s.length>0?s[0]:"related";return{id:l,source:"github_issue".concat(t.github_id),target:"github_issue".concat(a),relationType:o,classes:[o]}})},[d,u,t.github_id,n]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.EP,{...a,element:{id:"github_issue".concat(t.github_id),data:{id:"github_issue".concat(t.github_id),label:"#".concat(t.number),title:s,state:t.state,isPR:l,github_id:t.github_id,database_id:t.id},...null==a?void 0:a.element,classes:(0,f.cn)("entity","github-issue",{"pull-request":l},a.classes)},children:(0,r.jsx)(z,{data:t})}),h.map(e=>(0,r.jsx)(g.vh,{element:{id:e.id,data:{id:e.id,source:e.source,target:e.target,relationType:e.relationType},classes:e.classes}},e.id))]})}var $=n(54213);function U(e){if(!e)return{table:"unknown",schema:"public"};let t=e.split("_");return 1===t.length?{table:t[0],schema:"public"}:{table:t[t.length-1],schema:t.slice(0,-1).join("_")}}function P(e){let{data:t,...n}=e;(0,c.c3)("entities.default");let a="string"==typeof t?t:null==t?void 0:t.id,s="object"==typeof t?t:null,{table:l,schema:o}=U(null==s?void 0:s.__typename),i="".concat(l).concat(a?" ".concat(a):"");return(0,r.jsxs)(d.$,{variant:"outline",className:"h-auto p-2 justify-start gap-2 min-w-0",...n,children:[(0,r.jsx)($.A,{className:"w-4 h-4 flex-shrink-0"}),(0,r.jsx)("span",{className:"truncate text-xs",children:i}),(null==s?void 0:s.created_at)&&(0,r.jsx)("span",{className:"text-xs text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()})]})}function L(e){let{data:t,onClose:n,...a}=e,s=(0,c.c3)("entities.default");"string"==typeof t||null==t||t.id;let l="object"==typeof t?t:null;if(!l&&"string"==typeof t)return(0,r.jsx)(u.Zp,{className:"w-80",...a,children:(0,r.jsx)(u.Wu,{className:"p-4",children:(0,r.jsxs)("div",{className:"text-sm text-muted-foreground",children:[s("entityId"),": ",t,(0,r.jsx)("br",{}),(0,r.jsx)("span",{className:"text-xs",children:s("noAdditional")})]})})});let{table:o,schema:i}=U(null==l?void 0:l.__typename),h=["id","created_at","updated_at","__typename"],g=l?Object.fromEntries(Object.entries(l).filter(e=>{let[t]=e;return!h.includes(t)})):{};return(0,r.jsxs)(u.Zp,{className:"w-80",...a,children:[(0,r.jsx)(u.aR,{className:"pb-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("div",{className:"w-10 h-10 flex items-center justify-center bg-muted rounded-full",children:(0,r.jsx)($.A,{className:"w-5 h-5"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)(u.ZB,{className:"text-base capitalize",children:o}),"public"!==i&&(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[s("schema"),": ",i]})]})]}),n&&(0,r.jsx)(d.$,{variant:"ghost",size:"sm",onClick:n,className:"h-6 w-6 p-0",children:(0,r.jsx)(p.A,{className:"h-4 w-4"})})]})}),(0,r.jsx)(u.Wu,{className:"pt-0",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-1",children:[(null==l?void 0:l.id)&&(0,r.jsxs)(m.E,{variant:"outline",className:"text-xs",children:["ID: ",l.id]}),(null==l?void 0:l.__typename)&&(0,r.jsx)(m.E,{variant:"secondary",className:"text-xs",children:l.__typename})]}),(null==l?void 0:l.created_at)&&(0,r.jsxs)("div",{className:"text-xs text-muted-foreground",children:[s("created"),": ",new Date(l.created_at).toLocaleDateString()]}),(null==l?void 0:l.updated_at)&&(0,r.jsxs)("div",{className:"text-xs text-muted-foreground",children:[s("updated"),": ",new Date(l.updated_at).toLocaleDateString()]}),Object.keys(g).length>0&&(0,r.jsxs)("div",{className:"mt-3",children:[(0,r.jsxs)("div",{className:"text-xs font-medium mb-1",children:[s("data"),":"]}),(0,r.jsx)("div",{className:"bg-muted rounded p-2 text-xs font-mono overflow-auto max-h-32",children:(0,r.jsx)("pre",{children:JSON.stringify(g,null,2)})})]})]})})]})}function B(e){let{data:t,...n}=e;return(0,r.jsx)(g.EP,{...n,element:{id:t.id,data:{id:t.id,label:null==t?void 0:t.name},...null==n?void 0:n.element,classes:(0,f.cn)("entity",n.classes)}})}let F={users:a,accounts:s,issues:l,default:o};function H(e){let t=function(e){if(!e)return"default";let t=e.split("_");return(1===t.length?t[0]:t[t.length-1]).toLowerCase()}(e);return t in F?F[t]:o}function W(e){let{data:t,...n}=e,a="object"==typeof t?t:null,s=H(null==a?void 0:a.__typename).Button;return(0,r.jsx)(s,{data:t,...n})}function q(e){let{data:t,onClose:n,...a}=e,s="object"==typeof t?t:null,l=H(null==s?void 0:s.__typename).Card;return(0,r.jsx)(l,{data:t,onClose:n,...a})}function Z(e){let{data:t,...n}=e,a="object"==typeof t?t:null,s=H(null==a?void 0:a.__typename).CytoNode;return(0,r.jsx)(s,{data:t,...n})}},35929:(e,t,n)=>{n.d(t,{U:()=>a});let a=(0,n(65521).v)((e,t)=>({onDrawingComplete:null,currentRelationType:null,hasyxInstance:null,startDrawing:(t,n,a)=>{e({onDrawingComplete:a,currentRelationType:t,hasyxInstance:n})},completeDrawing:async(n,a,s)=>{let{onDrawingComplete:l,hasyxInstance:o}=t();l&&o&&(await l(n,a,s,o),e({onDrawingComplete:null,currentRelationType:null,hasyxInstance:null}))},cancelDrawing:()=>{e({onDrawingComplete:null,currentRelationType:null,hasyxInstance:null})}}))},49514:(e,t,n)=>{let a,s;n.d(t,{S_:()=>P,vh:()=>X,EP:()=>K,Lh:()=>Y,uU:()=>B});var l=n(95155),o=n(97168),r=n(12115),i=n(34613),c=n(73255),d=n.n(c),u=n(47650);let h=e=>{let{children:t,container:n,containerRef:a}=e,[s,l]=(0,r.useState)(!1);(0,r.useEffect)(()=>(l(!0),()=>l(!1)),[]);let o=n||(null==a?void 0:a.current)||("undefined"!=typeof document?document.body:null);return s&&o?(0,u.createPortal)(t,o):null};var m=n(78966),p=n.n(m),g=n(24108),f=n.n(g),x=n(29147),v=n.n(x),y=n(60245),b=n.n(y),j=n(50348),N=n(13853),C=n(32066),w=n(60376),E=n(35929),_=n(79206),k=n.n(_),G=n(54641),S=n(51886),M=n.n(S),R=n(69934),D=n.n(R),T=n(25012),A=n.n(T),O=n(86178),z=n.n(O),I=n(48711),$=n(53999);let U=(0,N.A)("cyto");G.A.use(k()),G.A.use(D()),G.A.use(M()),G.A.use(A()),G.A.use(z()),"object"==typeof window&&(n.e(1197).then(n.t.bind(n,41197,23)).then(e=>{a=e.default,G.A.use(a)}),n.e(7965).then(n.bind(n,37965)).then(e=>{s=e.default,G.A.use(s)}),d()(G.A)),i._;let P=(0,r.memo)(function(e){let{onLoaded:t,onInsert:n,buttons:a=!0,leftTop:s=null,rightTop:c=null,leftBottom:d=null,rightBottom:u=null,layout:h,className:m,style:g={},children:f=null,zoomHandler:x,translateHandler:y,...b}=e,[N,_]=(0,r.useState)(),{theme:k}=(0,C.D)();U("[THEME CHANGE] Cyto component rendered with theme: ".concat(k));let G=(0,r.useRef)(void 0);G.current=N,(0,r.useRef)(void 0);let S=(0,r.useRef)(void 0),M=(0,r.useRef)(void 0),R=(0,r.useRef)(void 0),D=(0,r.useRef)(void 0),{width:T,height:A}=(0,j.A)({targetRef:D}),[O,z]=(0,r.useState)({zoom:1,pan:{x:0,y:0}}),P=(0,r.useMemo)(()=>x||(e=>e),[x]),B=(0,r.useMemo)(()=>y||((e,t)=>[e,t]),[y]),H="#747474",W=(0,r.useCallback)(e=>{if(U("Graph onLoaded",e),N)return;_(e),G.current=e;let n=t=>{let n=e.pan(),a=e.zoom(),s=n.x,l=n.y,o=P(3*a),[r,i]=B(s,l);R.current&&(R.current.style["background-size"]="".concat(o,"em ").concat(o,"em"),R.current.style["background-position"]="".concat(r,"px ").concat(i,"px")),M.current&&n&&(M.current.style.transform="translate(".concat(s,"px, ").concat(l,"px) scale(").concat(a,")"))},a=e=>{var t;(null==e||null==(t=e.target)?void 0:t.id)&&(null==e||e.target.id())},s=e=>{var t;(null==e||null==(t=e.target)?void 0:t.id)&&(null==e||e.target.id())},l=(e,t,n,a)=>{},o=(e,t,n,a)=>{let s=t.data(),l=n.data();a.remove(),U("ehcomplete",s,l);try{let{completeDrawing:e,currentRelationType:t}=E.U.getState();e&&t&&e(s,l,t)}catch(e){U("Error in ehcomplete dependency handling:",e)}},r=e=>{U("bgtap",e)},i=t=>{e.emit("node:created:".concat(t.target.id()),[t.target])};return e.on("add","node",i),e.on("ehpreviewoff",l),e.on("ehcomplete",o),e.on("tap",r),e.on("viewport",n),e.on("mouseover",a),e.on("mouseout",s),e.nodes(),e.edges(),ee(),t&&t(e),()=>{e.removeListener("viewport",n),e.removeListener("mouseover",a),e.removeListener("mouseout",s),e.removeListener("ehpreviewoff",l),e.removeListener("ehcomplete",o),e.removeListener("tap",r),e.off("add","node",i)}},[N]),[q,Z]=(0,r.useState)({});(0,r.useRef)(q).current=q;let V=(0,r.useCallback)((e,t)=>{Z(n=>{let a={...n};return t?a[e]=t:delete a[e],a})},[]),K=(0,r.useRef)(new Map),[J,X]=(0,r.useState)([]);(0,r.useEffect)(()=>{var e;let t=v()(Object.values(q));(e=p()(t),new Promise(t=>{setTimeout(()=>{if(U("[CSS Vars] Starting resolveCssVars with ".concat(e.length," rules")),"undefined"==typeof document)return t(e);let n=getComputedStyle(document.documentElement),a=e.map(e=>{let t={};if(!e.style)return e;for(let[a,s]of Object.entries(e.style))if("string"==typeof s&&s.startsWith("var(")){let e=s.match(/var\((--[^,)]+)(,.*)?\)/);if(e){let l=e[1].trim(),o=n.getPropertyValue(l).trim();if(U("[CSS Vars] Resolving ".concat(l," for ").concat(a,": '").concat(o,"'")),o.startsWith("oklch(")){U("[CSS Vars] Detected oklch color, attempting to parse: '".concat(o,"'"));let e=(0,w.qgA)(o);if(U("[CSS Vars] parse result:",e),e){let t=(0,w.Var)(e);U("[CSS Vars] Converted oklch '".concat(o,"' to rgb '").concat(t,"'")),o=t}else U("[CSS Vars] Failed to parse oklch color: '".concat(o,"'"))}if(o)t[a]=o;else{let n=e[2]?e[2].substring(1).trim():void 0;n?t[a]=n.replace(/^['"]|['"]$/g,""):t[a]=s}}else t[a]=s}else t[a]=s;return{...e,style:t}});U("[CSS Vars] Finished resolveCssVars, returning ".concat(a.length," resolved rules")),t(a)},0)})).then(e=>{X(e)})},[q,k]);let Q=(0,r.useMemo)(()=>[],[]),Y=(0,r.useMemo)(()=>"object"==typeof h?h:"function"==typeof h?h(N):{name:"cola",refresh:10,maxSimulationTime:100,fit:!1,nodeDimensionsIncludeLabels:!0,edgeLength:function(e){let t=e.source(),n=e.target();return 100+(t.connectedEdges().length+n.connectedEdges().length)*10}},[h]),ee=(0,i._)(e=>{if(!G.current)return;let t=S.current;t&&(t.stop&&t.stop(),t.destroy&&t.destroy()),S.current=t=G.current.elements().layout(Y),t.run(),G.current.once("layoutready",()=>setTimeout(()=>{U("RELAYOUT")},300)),e&&e()},300),[et,en]=(0,r.useState)(null);(0,r.useEffect)(()=>{D.current&&en((0,l.jsx)(I.A,{cy:W,elements:Q,layout:Y,stylesheet:J,panningEnabled:!0,pan:null==O?void 0:O.pan,zoom:null==O?void 0:O.zoom,style:{width:"100%",height:"100%"}}))},[W,J]);let ea=(0,r.useCallback)(()=>{N&&(N.pan({x:0,y:0}),N.zoom(1),ee())},[N]),es=(0,r.useRef)(!1);(0,r.useEffect)(()=>{N&&!es.current&&(ea(),es.current=!0)},[N]);let[el,eo]=(0,r.useState)(null),[er,ei]=(0,r.useState)(!1);(0,r.useEffect)(()=>{er||eo(null)},[er]),(0,r.useEffect)(()=>{el&&ei(!0)},[el]);let[ec,ed]=(0,r.useState)(null);(0,r.useRef)(ec).current=ec;let eu=(0,r.useCallback)(()=>{if(N)if(ec)ec.disableDrawMode(),ec.destroy(),ed(null);else{let e=N.edgehandles({canLink:(e,t)=>{let n=e.data(),a=t.data();return n.github_id&&a.github_id},edgeParams:(e,t)=>{let n=e.data(),a=t.data();return U("edgeParams",e,n,t,a),{}}});e.enableDrawMode(),ed(e)}},[N,ec]),eh=(0,r.useMemo)(()=>({cyRef:G,layout:Y,layoutRef:S,relayout:ee,style:V,cy:N,classesRef:K,overlayRef:M,toggleDrawMode:eu}),[G,Y,S,ee,V,N,K,M,eu]),em=!0===a?"rightTop":!1===a?null:a,ep=(0,r.useMemo)(()=>!!a&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(o.$,{style:{width:"3em",height:"3em",padding:0},onClick:()=>ee(),variant:"outline",children:"\uD83D\uDD04"}),(0,l.jsx)(o.$,{style:{width:"3em",height:"3em",padding:0},onClick:ea,variant:"outline",children:"⚪"})]}),[a,ee,ea]),eg=(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"relative w-full h-full",ref:D,children:[!!er&&!!el&&(0,l.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10",children:(0,l.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-lg",children:[(0,l.jsx)("h3",{className:"text-lg font-medium mb-2",children:"Create Link"}),(0,l.jsxs)("p",{children:["From: ",el.from]}),(0,l.jsxs)("p",{children:["To: ",el.to]}),(0,l.jsxs)("p",{children:["Container: ",el.containerId]}),(0,l.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:[(0,l.jsx)(o.$,{onClick:()=>ei(!1),variant:"outline",children:"Cancel"}),(0,l.jsx)(o.$,{onClick:()=>{n&&n({from:el.from,to:el.to,containerId:el.containerId},{from:el.from,to:el.to,containerId:el.containerId}),ei(!1)},children:"Create"})]})]})}),(0,l.jsx)("div",{ref:R,...b,className:(0,$.cn)("absolute inset-0",m),style:{width:"100%",height:"100%",backgroundImage:"\n            radial-gradient(circle at 0 0, ".concat(H," 1px, transparent 1px),\n            radial-gradient(circle at .1em .1em, ").concat(H," 1px, transparent 1px),\n            radial-gradient(circle at 0 .1em, ").concat(H," 1px, transparent 1px),\n            radial-gradient(circle at .1em 0, ").concat(H," 1px, transparent 1px)\n          "),backgroundSize:"3em 3em",backgroundPosition:"0 0, 0 0, 0 0, 0 0",backgroundRepeat:"repeat",...g||{}}}),et,(0,l.jsxs)("div",{className:"absolute left-4 top-4 flex flex-col items-start gap-2 pointer-events-none [&>*]:pointer-events-auto",children:["leftTop"===em&&ep,s]}),(0,l.jsxs)("div",{className:"absolute right-4 top-4 flex flex-col items-end gap-2 pointer-events-none [&>*]:pointer-events-auto",children:["rightTop"===em&&ep,c]}),(0,l.jsxs)("div",{className:"absolute left-4 bottom-4 flex flex-col items-start gap-2 pointer-events-none [&>*]:pointer-events-auto",children:["leftBottom"===em&&ep,d]}),(0,l.jsxs)("div",{className:"absolute right-4 bottom-4 flex flex-col items-end gap-2 pointer-events-none [&>*]:pointer-events-auto",children:["rightBottom"===em&&ep,u]})]})}),ef=(0,r.useRef)(new Map),ex=(0,r.useCallback)((e,t)=>{let n=ef.current,a=n.get(e);a||n.set(e,a=new Set);let s=a.size;return a.add(t),!s},[]),ev=(0,r.useCallback)((e,t)=>{let n=ef.current,a=n.get(e)||new Set;n.set(e,a),a.delete(t);let s=a.values().next().value;s&&s(),0===a.size&&n.delete(e)},[]),ey=(0,r.useMemo)(()=>({mount:ex,unmount:ev}),[ex,ev]);return(0,l.jsx)(L.Provider,{value:eh,children:(0,l.jsxs)(F.Provider,{value:ey,children:[eg,!!N&&(0,l.jsx)("div",{ref:M,className:"absolute left-0 top-0",style:{transformOrigin:"top left",pointerEvents:"none"},children:f})]})})}),L=(0,r.createContext)(null);function B(){return(0,r.useContext)(L)}let F=(0,r.createContext)(null),H=e=>{let{id:t,children:n,boxRefCallback:a}=e,{mount:s,unmount:o}=function(){let e=(0,r.useContext)(F);if(!e)throw Error("useCytoReactNodes must be used within a CytoReactNodesProvider");return e}(),{overlayRef:i}=B(),c=(0,r.useCallback)(()=>m(!0),[]),d=(0,r.useMemo)(()=>s(t,c),[]),[u,m]=(0,r.useState)(d);return((0,r.useEffect)(()=>()=>{o(t,c)},[]),u)?(0,l.jsx)(h,{containerRef:i,children:(0,l.jsx)("div",{ref:a,style:{position:"absolute"},children:n})}):null},W=(0,r.createContext)(void 0);W.displayName="GraphElementsContext";let q=1,Z=e=>{var t,n;let{forwardedRef:a,element:s,ghost:o,children:i,onAdded:c,...d}=e,u=(0,r.useRef)(null),h=a&&"object"==typeof a&&"current"in a?a:u,{cy:m,relayout:p}=(0,r.useContext)(L),g=(0,r.useMemo)(()=>q++,[]),f=(0,r.useMemo)(()=>"ni-".concat(g).concat(o?"-ghost":""),[g,o]),x=(0,r.useContext)(W),v=(0,r.useMemo)(()=>{var t;return"".concat((null==e?void 0:e.id)||(null==s?void 0:s.id)||(null==s||null==(t=s.data)?void 0:t.id))},[null==e?void 0:e.id,s]);if(!v)throw U("Error: GraphNode !props.element.id && !props.element.data.id. Element:",s),Error("GraphNode !props.element.id && !props.element.data.id");s&&(s.id=v,s.data.id=v);let[y,j]=(0,r.useState)(null),N=(0,r.useCallback)(e=>{U("GraphNode [".concat(v,"] boxRefCallback called with node:"),e),e?j(e):j(null)},[v]),[C,w]=(0,r.useState)(!1);(0,r.useEffect)(()=>(w(!0),e.onMount&&e.onMount(s),()=>{e.onUnmount&&e.onUnmount(s)}),[s,e.onMount,e.onUnmount]);let[E,_]=(0,r.useState)(null),k=(0,r.useMemo)(()=>"string"==typeof(null==s?void 0:s.classes)?(null==s?void 0:s.classes).split(" "):(null==s?void 0:s.classes)||[],[null==s?void 0:s.classes]);(o?r.useEffect:r.useLayoutEffect)(()=>{var e,t;if(!m)return;let n=m.$id(v),l=!n.length;U("GraphNode [".concat(v,"] Effect - isNew: ").concat(l,", ghost: ").concat(o,", element.data.label: ").concat(null==s||null==(e=s.data)?void 0:e.label));let r={id:v,label:null==s||null==(t=s.data)?void 0:t.label,parent:x&&x.id()||void 0,...null==s?void 0:s.data};if(l){U("GraphNode [".concat(v,"] Creating new node"));let e={group:"nodes",data:r,position:null==s?void 0:s.position,classes:[f,...k],locked:null==s?void 0:s.locked,grabbable:null==s?void 0:s.grabbable};n=m.add(e),o&&(U("GraphNode [".concat(v,"] Setting as ghost")),n.addClass("ghost"),n.emit("ghost")),c&&c(n,m)}else{U("GraphNode [".concat(v,"] Updating existing node")),n.addClass(f),k.length>0&&n.addClass(k.join(" ")),U("GraphNode [".concat(v,"] prepare update. element.data:"),null==s?void 0:s.data,"dataForCy:",r);let e=n.classes().some(e=>e.startsWith("ni-")&&!e.endsWith("-ghost"));o?o&&e?U("GraphNode [".concat(v,"] Ghost component detected non-ghost classes - skipping data update to preserve labels")):(null==s?void 0:s.data)&&!b()(n.data(),r)&&(U("GraphNode [".concat(v,"] Updating data in Cytoscape. Old:"),n.data(),"New:",r),n.data(r)):(U("GraphNode [".concat(v,"] Force updating data for non-ghost component. Old:"),n.data(),"New:",r),n.data(r)),"boolean"==typeof(null==s?void 0:s.locked)&&n.locked()!==s.locked&&n[s.locked?"lock":"unlock"](),"boolean"==typeof(null==s?void 0:s.grabbable)&&n.grabbable()!==s.grabbable&&n[s.grabbable?"grabify":"ungrabify"]()}let i=n.classes(),u=i.some(e=>e.endsWith("-ghost")),p=i.some(e=>e.startsWith("ni-")&&!e.endsWith("-ghost")),g=n.hasClass("ghost");U("GraphNode [".concat(v,"] Checking ghost state. Current ghost prop: ").concat(o,", hasClass('ghost'): ").concat(g,", has ghost classes: ").concat(u,", has non-ghost classes: ").concat(p,", classes:"),i),!o&&u?(U("GraphNode [".concat(v,"] *** NON-GHOST COMPONENT - UPDATING DATA ***")),U("GraphNode [".concat(v,"] Current data:"),n.data(),"New data:",r),n.data(r),n.removeClass("ghost"),n.emit("unghost"),U("GraphNode [".concat(v,"] After data update - data:"),n.data(),"classes:",n.classes())):!o&&g?(U("GraphNode [".concat(v,"] *** NON-GHOST COMPONENT TAKING OVER GHOST NODE ***")),U("GraphNode [".concat(v,"] Before unghost - data:"),n.data(),"classes:",n.classes()),n.data(r),n.removeClass("ghost"),U("GraphNode [".concat(v,"] After removeClass('ghost') - classes:"),n.classes()),n.emit("unghost"),U("GraphNode [".concat(v,"] After unghost event - data:"),n.data(),"classes:",n.classes())):o&&p?U("GraphNode [".concat(v,"] *** GHOST COMPONENT DETECTED NON-GHOST CLASSES - SKIPPING GHOST STATE ***")):!o||g||p||(U("GraphNode [".concat(v,"] *** GHOST COMPONENT ENSURING GHOST STATE ***")),n.addClass("ghost"),n.emit("ghost")),h.current=n,"function"==typeof a&&a(n),_(n);let{onClick:y,onGhost:j,onUnghost:N}=d,C=e=>y&&y(e),w=e=>{U("GraphNode [".concat(v,"] ghost event triggered - node will be styled as ghost")),j&&j(e)},E=e=>{U("GraphNode [".concat(v,"] unghost event triggered - node will be styled as normal")),N&&N(e)};return n&&"function"==typeof n.on&&(n.on("click",C),n.on("ghost",w),n.on("unghost",E)),()=>{n&&"function"==typeof n.off&&(n.off("click",C),n.off("ghost",w),n.off("unghost",E));let e=m&&"function"==typeof m.$id?m.$id(v):null;if(e&&e.length&&"function"==typeof e.inside&&e.inside()){e.removeClass(f);let t=e.classes(),n=Array.isArray(t)?t.filter(e=>"string"==typeof e&&e.startsWith("ni-")):[];if(0===n.length)e.remove();else{let t=n.filter(e=>!e.endsWith("-ghost")),a=n.filter(e=>e.endsWith("-ghost"));if(0===t.length&&a.length>0){U("GraphNode [".concat(v,"] No non-ghost instances left, emitting ghost."));let t={id:v,parent:e.data("parent")};e.data(t),e.addClass("ghost"),e.emit("ghost")}else t.length>0&&(U("GraphNode [".concat(v,"] Non-ghost instances still exist, ensuring unghost.")),e.removeClass("ghost"),e.emit("unghost"))}}_&&_(null)}},[m,v,o,null==s||null==(t=s.data)?void 0:t.label,null==s||null==(n=s.data)?void 0:n.id,null==s?void 0:s.locked,null==s?void 0:s.grabbable,JSON.stringify(k),f,c,h,a,d.onClick,d.onGhost,d.onUnghost,_,x]);let G=(0,r.useRef)(null);return(0,r.useEffect)(()=>{G.current=e=>{if(y){let t="translate(calc(".concat(e.x,"px - 50%), calc(").concat(e.y,"px - 50%))");y.style.transform=t}}},[v,y]),(0,r.useEffect)(()=>{if(!i&&!o)return void U("GraphNode [".concat(v,"] Positioning/Resize effect: No children and not a ghost node. Skipping."));if(!C||!E||!E.length||!E.inside()||i&&!y){C||U("GraphNode [".concat(v,"] Positioning effect: Not mounted yet.")),E?E.length?E.inside()||U("GraphNode [".concat(v,"] Positioning effect: cytoscapeNode is not inside the graph.")):U("GraphNode [".concat(v,"] Positioning effect: cytoscapeNode has no length (empty collection).")):U("GraphNode [".concat(v,"] Positioning effect: cytoscapeNode is null.")),i&&!y&&U("GraphNode [".concat(v,"] Positioning effect: htmlElement (for children) is null."));return}if(y){let e=E.position();U("GraphNode [".concat(v,"] Positioning effect (run): currentCyEl ready. Position from cy:"),e,"Transforming htmlElement:",y),e&&G.current?G.current(e):e||U("GraphNode [".concat(v,"] Positioning effect (run): currentCyEl.position() returned null/undefined."))}else i&&U("GraphNode [".concat(v,"] Positioning effect (run): htmlElement is null despite children being present. Cannot set initial transform."));let e=e=>{U("GraphNode [".concat(v,"] 'position' event triggered. Event target position:"),e.target.position()),G.current&&G.current(e.target.position())};if(E.on("position",e),y){let e=E.position();e&&G.current&&G.current(e)}let t=null,n=null;if(y){U("GraphNode [".concat(v,"] Setting up ResizeObserver as htmlElement is available.")),(n=new ResizeObserver(e=>{t&&cancelAnimationFrame(t),t=requestAnimationFrame(()=>{for(let t of e)if(t.target===y&&y&&E&&E.length&&E.inside()){let{width:e,height:n}=t.contentRect;U("GraphNode [".concat(v,"] ResizeObserver: HTML element size w=").concat(e,", h=").concat(n));let a=e=>"string"==typeof e?parseFloat(e):"number"==typeof e?e:0,s=a(E.style("width")),l=a(E.style("height"));U("GraphNode [".concat(v,"] ResizeObserver: Current CyNode size w=").concat(s,", h=").concat(l)),e>0&&n>0&&(Math.abs(s-e)>.5||Math.abs(l-n)>.5)&&(U("GraphNode [".concat(v,"] ResizeObserver: Updating CyNode size to w=").concat(e,", h=").concat(n)),E.style({width:e,height:n}),p&&(U("GraphNode [".concat(v,"] ResizeObserver: Triggering relayout.")),p()))}})})).observe(y);let e=y.offsetWidth,a=y.offsetHeight;if(U("GraphNode [".concat(v,"] Initial HTML size: w=").concat(e,", h=").concat(a)),e>0&&a>0&&E&&E.length&&E.inside()){let t=e=>"string"==typeof e?parseFloat(e):"number"==typeof e?e:0,n=t(E.style("width")),s=t(E.style("height"));U("GraphNode [".concat(v,"] Initial CyNode size: w=").concat(n,", h=").concat(s)),(Math.abs(n-e)>.5||Math.abs(s-a)>.5)&&(U("GraphNode [".concat(v,"] Initial Sync: Updating CyNode size to w=").concat(e,", h=").concat(a)),E.style({width:e,height:a}),p&&(U("GraphNode [".concat(v,"] Initial Sync: Triggering relayout.")),p()))}}else i&&U("GraphNode [".concat(v,"] ResizeObserver setup skipped: htmlElement is null despite children being present."));return()=>{E&&E.length&&E.inside()&&(E.style({width:"auto",height:"auto"}),E.off("position",e)),y&&n&&n.unobserve(y),t&&cancelAnimationFrame(t),n&&n.disconnect()}},[v,p,C,E,G,y,i,o]),(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(W.Provider,{value:E,children:!!i&&(0,l.jsx)(H,{id:v,children:i,boxRefCallback:N})})})},V=(0,r.forwardRef)((e,t)=>(0,l.jsx)(Z,{...e,forwardedRef:t}));V.displayName="GraphNode";let K=(0,r.memo)(V,(e,t)=>{var n,a,s,l,o,r,i,c,d,u,h,m;return e.ghost===t.ghost&&(null==(n=e.element)?void 0:n.id)===(null==(a=t.element)?void 0:a.id)&&!!b()(null==(s=e.element)?void 0:s.data,null==(l=t.element)?void 0:l.data)&&!!b()(null==(o=e.element)?void 0:o.position,null==(r=t.element)?void 0:r.position)&&!!b()(null==(i=e.element)?void 0:i.classes,null==(c=t.element)?void 0:c.classes)&&(null==(d=e.element)?void 0:d.locked)===(null==(u=t.element)?void 0:u.locked)&&(null==(h=e.element)?void 0:h.grabbable)===(null==(m=t.element)?void 0:m.grabbable)&&e.children===t.children&&!0}),J=1,X=(0,r.memo)(function(e){let{element:t,children:n=null,...a}=e,{cy:s,relayout:o,classesRef:i}=(0,r.useContext)(L),c=(0,r.useMemo)(()=>J++,[]),d=(0,r.useMemo)(()=>"ei-".concat(c),[]),u=(0,r.useMemo)(()=>{var e,n,a;let s=(null==t?void 0:t.id)||(null==t||null==(e=t.data)?void 0:e.id);if(!s){if((null==t||null==(n=t.data)?void 0:n.source)&&(null==t||null==(a=t.data)?void 0:a.target))return U("GraphEdge: Missing id for edge between ".concat(t.data.source," and ").concat(t.data.target,". Generating fallback: edge-").concat(t.data.source,"-").concat(t.data.target,"-").concat(c)),"edge-".concat(t.data.source,"-").concat(t.data.target,"-").concat(c);let e="generated-edge-".concat(c);return U("GraphEdge: element.id or element.data.id is required, and source/target are also missing. Using insecure fallback ID: ".concat(e,". Element data: ").concat(JSON.stringify(null==t?void 0:t.data))),e}return"".concat(s)},[t,c]),[h,m]=(0,r.useState)(!1),p=(0,r.useCallback)(()=>{U("GraphEdge [".concat(u,"] mount called (all ghost nodes ready). Setting isMounted to true.")),m(!0)},[u]),g=(0,r.useMemo)(()=>"string"==typeof(null==t?void 0:t.classes)?(null==t?void 0:t.classes).split(" "):(null==t?void 0:t.classes)||[],[null==t?void 0:t.classes]),x=(0,r.useCallback)(()=>{var e,n;if(!s||!(null==t||null==(e=t.data)?void 0:e.source)||!(null==t||null==(n=t.data)?void 0:n.target))return void U("GraphEdge [".concat(u,"] addEdgeToCytoscape: cy instance or source/target data missing. Element:"),t);if(!h)return void U("GraphEdge [".concat(u,"] addEdgeToCytoscape: Not mounted yet (ghosts not ready)."));U("GraphEdge [".concat(u,"] addEdgeToCytoscape: Proceeding. Element:"),t);let l=t.data.source,o=t.data.target,r=s.$id(u);if(r.length>0){U("GraphEdge [".concat(u,"] addEdgeToCytoscape: Edge with ID '").concat(u,"' already exists. Ensuring instance class '").concat(d,"' is present.")),r.hasClass(d)||r.addClass(d);return}let i=()=>{U("GraphEdge [".concat(u,"] tryRecreate: SourceID=").concat(l,", TargetID=").concat(o));let e=s.$id(l),n=s.$id(o);if(U("GraphEdge [".concat(u,"] tryRecreate: Source node '").concat(l,"' found: ").concat(e.length>0,", Target node '").concat(o,"' found: ").concat(n.length>0)),!e.length||!n.length){e.length||U("GraphEdge [".concat(u,"] tryRecreate: Source node ").concat(l," NOT FOUND in Cytoscape when trying to create edge.")),n.length||U("GraphEdge [".concat(u,"] tryRecreate: Target node ").concat(o," NOT FOUND in Cytoscape when trying to create edge."));return}let r={group:"edges",data:{...t.data||{}},classes:[d,...g]};r.data.id=u,U("GraphEdge [".concat(u,"] tryRecreate: Adding edge to Cytoscape:"),r);let i=s.add(r),c=e=>{U("GraphEdge [".concat(u,"] onClick event"),{event:e,edge:i,props:a}),a.onClick&&a.onClick(e)};i.on("click",c);let h=i.scratch("_cytoReactHandlers")||{};h.onClick=c,i.scratch("_cytoReactHandlers",h)},c=s.$id(l),m=s.$id(o),p=!1,f=!1;c.length||(p=!0,U("GraphEdge [".concat(u,"] addEdgeToCytoscape: Source node ").concat(l," not found. Waiting for node:created:").concat(l)),s.once("node:created:".concat(l),()=>{U("GraphEdge [".concat(u,"] addEdgeToCytoscape: node:created:").concat(l," event received.")),i()})),m.length||(f=!0,U("GraphEdge [".concat(u,"] addEdgeToCytoscape: Target node ").concat(o," not found. Waiting for node:created:").concat(o)),s.once("node:created:".concat(o),()=>{U("GraphEdge [".concat(u,"] addEdgeToCytoscape: node:created:").concat(o," event received.")),i()})),p||f||(U("GraphEdge [".concat(u,"] addEdgeToCytoscape: Both source and target nodes found initially.")),i())},[s,t,h,u,d,a.onClick]);(0,r.useEffect)(()=>{var e,n,a,l,o,r,i;if(U("GraphEdge [".concat(u,"] main effect. isMounted: ").concat(h,", element.id: ").concat(null==t?void 0:t.id,", element.data.id: ").concat(null==t||null==(e=t.data)?void 0:e.id,", element.data.source: ").concat(null==t||null==(n=t.data)?void 0:n.source,", element.data.target: ").concat(null==t||null==(a=t.data)?void 0:a.target)),!s||!h||!(null==t||null==(l=t.data)?void 0:l.source)||!(null==t||null==(o=t.data)?void 0:o.target)){s||U("GraphEdge [".concat(u,"] main effect: cy not available.")),h||U("GraphEdge [".concat(u,"] main effect: not mounted (ghosts not ready).")),(null==t||null==(r=t.data)?void 0:r.source)&&(null==t||null==(i=t.data)?void 0:i.target)||U("GraphEdge [".concat(u,"] main effect: source or target missing in element.data."));return}let c=s.$id(u);if(c.length){U("GraphEdge [".concat(u,"] main effect: Edge ").concat(u," exists. Checking for data updates."));let e=c.data(),n={...t.data,id:u},a=!1;for(let t in n)if(!b()(e[t],n[t])){a=!0;break}for(let t in e)if(n.hasOwnProperty(t)&&void 0===n[t]&&void 0!==e[t]){a=!0;break}a?(U("GraphEdge [".concat(u,"] main effect: Data changed. Updating edge data. New:"),t.data,"Old in Cy:",e),c.data(t.data)):U("GraphEdge [".concat(u,"] main effect: Data for edge ").concat(u," seems unchanged.")),c.hasClass(d)||(U("GraphEdge [".concat(u,"] main effect: Adding instance class '").concat(d,"' to existing edge.")),c.addClass(d))}else U("GraphEdge [".concat(u,"] main effect: Edge does not exist in Cytoscape. Calling addEdgeToCytoscape.")),x()},[s,t,h,u,d,x,o]),(0,r.useEffect)(()=>()=>{if(s){let e=s.$id(u);e.length?(U("GraphEdge [".concat(u,"] Unmounting React component: Removing edge '").concat(u,"' from Cytoscape.")),e.remove()):U("GraphEdge [".concat(u,"] Unmounting React component: Edge '").concat(u,"' not found in Cytoscape for removal."))}},[s,u]);let v=(0,r.useRef)([]);(0,r.useEffect)(()=>{if(!s||!h||!(null==i?void 0:i.current))return;let e=s.$id(u);if(!e.length)return;let n=i.current,a=v.current,l=(null==t?void 0:t.classes)||[];if(!b()(a,l)){U("GraphEdge [".concat(u,"] Classes prop changed. Previous:"),a,"Next:",l);let t=f()(a,l),s=f()(l,a);n[u]=n[u]||{};let o=n[u];t.forEach(t=>{o[t]=(o[t]||1)-1,o[t]<=0&&(U("GraphEdge [".concat(u,"] Removing class '").concat(t,"' from Cytoscape element for edge ").concat(u,".")),e.removeClass(t),delete o[t])}),s.forEach(t=>{o[t]=(o[t]||0)+1,1===o[t]&&(U("GraphEdge [".concat(u,"] Adding class '").concat(t,"' to Cytoscape element for edge ").concat(u,".")),e.addClass(t))}),v.current=[...l]}},[s,u,h,null==t?void 0:t.classes,i]),(0,r.useEffect)(()=>()=>{if(!(null==i?void 0:i.current)||!i.current[u]||!v.current)return;let e=i.current,t=e[u],n=v.current;U("GraphEdge [".concat(u,"] Unmounting React component: Cleaning up its classes in classesRef. Classes managed:"),n),n.forEach(e=>{t&&t[e]&&(t[e]--,t[e]<=0&&delete t[e])}),t&&0===Object.keys(t).length&&delete e[u]},[u,i]);let y=(0,r.useRef)(0),j=(0,r.useCallback)(()=>{y.current++,U("GraphEdge [".concat(u,"] ghostMounted. ghostsRef.current: ").concat(y.current)),y.current>=2&&p()},[u,p]),N=(0,r.useCallback)((e,t)=>{U("GraphEdge [".concat(u,"] CytoNode ").concat(e," (ghost) mounted:"),null==t?void 0:t.id,"Calling ghostMounted."),j()},[j,u]),C=(0,r.useCallback)((e,t)=>{U("GraphEdge [".concat(u,"] CytoNode ").concat(e," (ghost) unmounted:"),null==t?void 0:t.id)},[u]),w=(0,r.useRef)(!1);return(0,r.useEffect)(()=>(h&&!w.current&&(U("GraphEdge [".concat(u,"] Main edge component isMounted=true. Calling props.onMount.")),w.current=!0,a.onMount&&a.onMount(t)),()=>{w.current&&(U("GraphEdge [".concat(u,"] Main edge component unmounting. Calling props.onUnmount.")),w.current=!1,a.onUnmount&&a.onUnmount(t))}),[h,t,a.onMount,a.onUnmount]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(K,{element:{id:t.data.source,data:{id:t.data.source}},ghost:!0,onMount:e=>N("source",e),onUnmount:e=>C("source",e)}),(0,l.jsx)(K,{element:{id:t.data.target,data:{id:t.data.target}},ghost:!0,onMount:e=>N("target",e),onUnmount:e=>C("target",e)})]})},(e,t)=>{var n,a,s,l,o,r;return(null==(n=e.element)?void 0:n.id)===(null==(a=t.element)?void 0:a.id)&&!!b()(null==(s=e.element)?void 0:s.data,null==(l=t.element)?void 0:l.data)&&!!b()(null==(o=e.element)?void 0:o.classes,null==(r=t.element)?void 0:r.classes)&&e.onClick===t.onClick&&e.onMount===t.onMount&&e.onUnmount===t.onUnmount}),Q=1,Y=(0,r.memo)(function(e){let{stylesheet:t}=e,n=(0,r.useMemo)(()=>Q++,[]),{style:a}=(0,r.useContext)(L);return(0,r.useEffect)(()=>(a&&a(n,t),()=>{a&&a(n,void 0)}),[n,a,t]),null},(e,t)=>b()(e.stylesheet,t.stylesheet))},82665:(e,t,n)=>{n.d(t,{o0:()=>m,oX:()=>g});var a=n(95155),s=n(97168),l=n(52312),o=n(49514),r=n(4005),i=n(52620),c=n(63791),d=n(54416),u=n(84616),h=n(12115);(0,n(13853).A)("renderer");let m=e=>{let{queries:t,setQueries:n,schema:o=c}=e,r=e=>{n(t=>t.filter((t,n)=>n!==e))},i=(e,t)=>{n(n=>n.map((n,a)=>a===e?t:n))};return(0,a.jsxs)(a.Fragment,{children:[t.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(l.kA,{value:e,onChange:e=>i(t,e),defaultTable:"users",schema:o,children:(0,a.jsx)("span",{className:"max-w-[100px] truncate",children:e.table})}),(0,a.jsx)(s.$,{variant:"outline",size:"icon",className:"square ml-1",onClick:()=>r(t),children:(0,a.jsx)(d.A,{className:"h-4 w-4"})})]},t)),(0,a.jsx)(s.$,{variant:"outline",size:"sm",className:"square",onClick:()=>{let e={table:"users",where:{},returning:["id","name"],limit:10};n(t=>[...t,e])},children:(0,a.jsx)(u.A,{})})]})},p=e=>{let{query:t,renderer:n}=e,{data:s=[]}=(0,i.useSubscription)(t),l=(0,h.useMemo)(()=>s.map(n),[s,n]);return(0,a.jsx)(a.Fragment,{children:l})},g=e=>{let{queries:t,schema:n,renderer:s,onClick:l,EntityButtonComponent:o=r.$n,availableIssues:i}=e,c=(0,h.useCallback)(e=>(0,a.jsx)(v,{object:e,onClick:l,schema:n,EntityButtonComponent:o,availableIssues:i},"".concat(e.__typename,"-").concat(e.id)),[s,i]),d=s||c,u=(0,h.useMemo)(()=>t.map((e,t)=>(0,a.jsx)(p,{query:e,renderer:d},t)),[t,s,i]);return(0,a.jsx)(a.Fragment,{children:u})},f=e=>t=>{let n=null==t?void 0:t.__typename;if(!n)return{objectRelations:{},arrayRelations:{},idFields:[]};let a=(0,l.Lg)(e,n);return{objectRelations:a,arrayRelations:(0,l.Xu)(e,n),idFields:(0,l.jB)(e,n)}},x=e=>{let{source:t,target:n}=e;return(0,a.jsx)(o.vh,{element:{id:"edge-".concat(t.__typename,"-").concat(t.id,"-").concat(n.__typename,"-").concat(n.id),data:{id:"edge-".concat(t.__typename,"-").concat(t.id,"-").concat(n.__typename,"-").concat(n.id),source:"".concat(t.id),target:"".concat(n.id)}}})},v=e=>{let{object:t,onClick:n,schema:s,parseRow:l,EntityButtonComponent:o=r.$n,availableIssues:i}=e,c=(0,h.useMemo)(()=>l||f(s),[s]);if(!t||!t.id||!t.__typename)return null;let d="".concat(t.__typename,"-").concat(t.id),{objectRelations:u,arrayRelations:m}=(0,h.useMemo)(()=>c(t),[t]),p=(0,h.useMemo)(()=>{let e=new Map,l=new Map;for(let r in u){let h=t[r];if(h&&h.id){let m=h.__typename||u[r],p={...h,__typename:m},g="".concat(p.__typename,"-").concat(p.id);e.has(g)||e.set(g,(0,a.jsx)(v,{object:p,onClick:n,schema:s,parseRow:c,EntityButtonComponent:o,availableIssues:i},g));let f="edge-".concat(d,"-").concat(g);l.has(f)||l.set(f,(0,a.jsx)(x,{source:t,target:p},f))}}for(let r in m){let u=t[r];Array.isArray(u)&&u.forEach(u=>{if(u&&u.id){let h=u.__typename||m[r],p={...u,__typename:h},g="".concat(p.__typename,"-").concat(p.id);e.has(g)||e.set(g,(0,a.jsx)(v,{object:p,onClick:n,schema:s,parseRow:c,EntityButtonComponent:o,availableIssues:i},g));let f="edge-".concat(d,"-").concat(g);l.has(f)||l.set(f,(0,a.jsx)(x,{source:t,target:p},f))}})}return{children:Array.from(e.values()),edges:Array.from(l.values())}},[t,u,m,n,d]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.EP,{data:t,availableIssues:i}),p.edges,p.children]})}},96426:(e,t,n)=>{n.d(t,{n:()=>g});var a=n(95155),s=n(12115),l=n(86380),o=n(3826),r=n(6905),i=n(80660);function c(e,t){!function(e,t){let n=l.KE.marks(e);return!!n&&!0===n[t]}(e,t)?l.KE.addMark(e,t,!0):l.KE.removeMark(e,t)}function d(e,t){let[n]=Array.from(l.KE.nodes(e,{match:e=>l.Hg.isElement(e)&&e.type===t}));return!!n}function u(e,t){l.gB.setNodes(e,{type:t})}function h(e,t){let n=d(e,t);l.gB.unwrapNodes(e,{match:e=>l.Hg.isElement(e)&&("ul"===e.type||"ol"===e.type),split:!0}),l.gB.setNodes(e,{type:n?"p":"li"}),n||l.gB.wrapNodes(e,{type:t,children:[]})}let m=e=>{let{attributes:t,children:n,element:s}=e;switch(s.type){case"h1":return(0,a.jsx)("h1",{...t,className:"text-2xl font-bold my-2",children:n});case"h2":return(0,a.jsx)("h2",{...t,className:"text-xl font-semibold my-2",children:n});case"blockquote":return(0,a.jsx)("blockquote",{...t,className:"border-l-4 pl-3 italic my-2",children:n});case"code_block":return(0,a.jsx)("pre",{...t,className:"bg-muted p-2 rounded font-mono text-sm overflow-auto",children:(0,a.jsx)("code",{children:n})});case"ul":return(0,a.jsx)("ul",{...t,className:"list-disc pl-6 my-2",children:n});case"ol":return(0,a.jsx)("ol",{...t,className:"list-decimal pl-6 my-2",children:n});case"li":return(0,a.jsx)("li",{...t,children:n});case"a":return(0,a.jsx)("a",{...t,href:s.url,className:"text-blue-500 underline",target:"_blank",rel:"noreferrer",children:n});default:return(0,a.jsx)("p",{...t,className:"my-2 leading-6",children:n})}},p=e=>{let{attributes:t,children:n,leaf:s}=e;return s.bold&&(n=(0,a.jsx)("strong",{children:n})),s.italic&&(n=(0,a.jsx)("em",{children:n})),s.code&&(n=(0,a.jsx)("code",{className:"bg-muted px-1 rounded font-mono text-sm",children:n})),(0,a.jsx)("span",{...t,children:n})};function g(e){let{value:t,onChange:n,placeholder:g,minHeight:x=160,className:v}=e,y=(0,s.useMemo)(()=>(0,r.$k)((0,o.o$)((0,l.ie)())),[]),b=(0,s.useMemo)(()=>{try{let e=(0,i.$r)(y,t||"");if(Array.isArray(e)&&e.length>0)return e}catch(e){}return[{type:"p",children:[{text:""}]}]},[]),[j,N]=(0,s.useState)(b),[C,w]=(0,s.useState)(t||"");(0,s.useEffect)(()=>{if(t!==C)try{let e=(0,i.$r)(y,t||"");N(Array.isArray(e)&&e.length>0?e:b),w(t||"")}catch(e){}},[t]);let E=(0,s.useCallback)(e=>{N(e);try{let t=(0,i.g$)(e);w(t),n(t)}catch(e){}},[n]);return(0,a.jsxs)("div",{className:v,children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 border rounded-t px-2 py-1 bg-background",children:[(0,a.jsx)(f,{onMouseDown:e=>{e.preventDefault(),c(y,"bold")},label:"B",title:"Bold (Ctrl+B)",className:"font-bold"}),(0,a.jsx)(f,{onMouseDown:e=>{e.preventDefault(),c(y,"italic")},label:"I",title:"Italic (Ctrl+I)",className:"italic"}),(0,a.jsx)(f,{onMouseDown:e=>{e.preventDefault(),c(y,"code")},label:"<>",title:"Code"}),(0,a.jsx)("div",{className:"w-px h-5 bg-border mx-1"}),(0,a.jsx)(f,{onMouseDown:e=>{e.preventDefault(),u(y,d(y,"h1")?"p":"h1")},label:"H1",title:"Heading 1"}),(0,a.jsx)(f,{onMouseDown:e=>{e.preventDefault(),u(y,d(y,"h2")?"p":"h2")},label:"H2",title:"Heading 2"}),(0,a.jsx)("div",{className:"w-px h-5 bg-border mx-1"}),(0,a.jsx)(f,{onMouseDown:e=>{e.preventDefault(),h(y,"ul")},label:"• List",title:"Bulleted list"}),(0,a.jsx)(f,{onMouseDown:e=>{e.preventDefault(),h(y,"ol")},label:"1. List",title:"Numbered list"}),(0,a.jsx)("div",{className:"w-px h-5 bg-border mx-1"}),(0,a.jsx)(f,{onMouseDown:e=>{var t,n;e.preventDefault();let a=window.prompt("Enter URL");a&&(t=y,(n=a)&&(t.selection&&l.Q6.isCollapsed(t.selection)&&l.gB.insertText(t,n),l.gB.wrapNodes(t,{type:"a",url:n,children:[]},{split:!0})))},label:"Link",title:"Insert link"})]}),(0,a.jsx)(o.A,{editor:y,initialValue:j,onChange:E,children:(0,a.jsx)(o.Fo,{placeholder:g,className:"border rounded-b px-3 py-2 outline-none focus:ring-2 focus:ring-ring",style:{minHeight:x},renderElement:e=>(0,a.jsx)(m,{...e}),renderLeaf:e=>(0,a.jsx)(p,{...e}),spellCheck:!0,autoFocus:!1,onKeyDown:e=>{e.ctrlKey&&("b"===e.key.toLowerCase()&&(e.preventDefault(),c(y,"bold")),"i"===e.key.toLowerCase()&&(e.preventDefault(),c(y,"italic")))}})})]})}function f(e){let{label:t,title:n,onMouseDown:s,className:l}=e;return(0,a.jsx)("button",{type:"button",title:n,onMouseDown:s,className:"text-xs px-2 py-1 rounded hover:bg-accent hover:text-accent-foreground "+(l||""),children:t})}}}]);