"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[817],{60817:(e,c,r)=>{r.d(c,{clearAllCaches:()=>s,clearCache:()=>o,completePWAReset:()=>l,forceReloadFromServer:()=>n});let t=(0,r(13853).A)("pwa-cache");async function a(){if(!("caches"in window))return t("Cache API not supported"),[];try{let e=await caches.keys(),c=[];for(let r of e){let e=await caches.open(r),t=await e.keys(),a=0,o=[];for(let e of t)o.push(e.url),a+=1024;c.push({name:r,entries:t.length,estimatedSize:a,lastModified:new Date,keys:o})}return t("Found ".concat(c.length," caches with total ").concat(c.reduce((e,c)=>e+c.entries,0)," entries")),c}catch(e){return t("Failed to get cache details:",e),[]}}async function o(e){if(!("caches"in window))return t("Cache API not supported"),!1;try{let c=await caches.delete(e);return t('Cache "'.concat(e,'" ').concat(c?"deleted successfully":"not found or failed to delete")),c}catch(c){return t('Failed to clear cache "'.concat(e,'":'),c),!1}}async function s(){let e={success:!0,clearedCaches:[],errors:[],totalBytesFreed:0};if(!("caches"in window))return e.success=!1,e.errors.push("Cache API not supported"),e;try{let c=await caches.keys();for(let r of(t("Clearing ".concat(c.length," caches...")),e.totalBytesFreed=(await a()).reduce((e,c)=>e+c.estimatedSize,0),c))try{await caches.delete(r)?(e.clearedCaches.push(r),t("✓ Cleared cache: ".concat(r))):(e.errors.push("Failed to delete cache: ".concat(r)),t("✗ Failed to clear cache: ".concat(r)))}catch(c){e.errors.push("Error deleting cache ".concat(r,": ").concat(c)),t("✗ Error clearing cache ".concat(r,":"),c)}e.success=0===e.errors.length,t("Cache cleanup complete. Success: ".concat(e.success,", Cleared: ").concat(e.clearedCaches.length,", Errors: ").concat(e.errors.length))}catch(c){e.success=!1,e.errors.push("Failed to enumerate caches: ".concat(c)),t("Failed to enumerate caches:",c)}return e}async function n(){t("Forcing reload from server...");try{await s(),localStorage.clear(),sessionStorage.clear(),t("Cleared local storage");let e=new URL(window.location.href);e.searchParams.set("_cache_bust",Date.now().toString()),window.location.replace(e.toString())}catch(e){t("Failed to force reload:",e),window.location.reload()}}async function i(){let e=[];if(!("serviceWorker"in navigator))return t("Service Worker not supported"),e;try{let c=await navigator.serviceWorker.getRegistrations();for(let r of(t("Found ".concat(c.length," service worker registrations")),c))try{let c=r.scope;await r.unregister()?(e.push(c),t("✓ Unregistered service worker: ".concat(c))):t("✗ Failed to unregister service worker: ".concat(c))}catch(e){t("✗ Error unregistering service worker:",e)}}catch(e){t("Failed to get service worker registrations:",e)}return e}async function l(){let e={success:!0,actions:[],errors:[]};t("Starting complete PWA reset...");try{let c=await s();c.success?e.actions.push("Cleared ".concat(c.clearedCaches.length," caches")):e.errors.push(...c.errors);let r=await i();r.length>0&&e.actions.push("Unregistered ".concat(r.length," service workers"));try{localStorage.clear(),sessionStorage.clear(),e.actions.push("Cleared local and session storage")}catch(c){e.errors.push("Failed to clear storage: ".concat(c))}try{if("indexedDB"in window&&indexedDB.databases){let c=await indexedDB.databases();for(let e of c)e.name&&await new Promise((c,r)=>{let a=indexedDB.deleteDatabase(e.name);a.onsuccess=()=>c(),a.onerror=()=>r(a.error),a.onblocked=()=>{t("Database deletion blocked: ".concat(e.name)),c()}});e.actions.push("Cleared ".concat(c.length," IndexedDB databases"))}}catch(c){e.errors.push("Failed to clear IndexedDB: ".concat(c))}try{document.cookie.split(";").forEach(function(e){document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+new Date().toUTCString()+";path=/")}),e.actions.push("Cleared cookies")}catch(c){e.errors.push("Failed to clear cookies: ".concat(c))}e.success=0===e.errors.length,t("PWA reset complete. Success: ".concat(e.success)),t("Actions taken:",e.actions),e.errors.length>0&&t("Errors:",e.errors)}catch(c){e.success=!1,e.errors.push("Unexpected error during reset: ".concat(c)),t("Unexpected error during PWA reset:",c)}return e}}}]);